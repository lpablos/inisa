import{r as s,j as e}from"./app-6c82f11e.js";import{B as v}from"./button.esm-41370389.js";import{D as S}from"./dialog.esm-1817fed8.js";import{P as E}from"./progressspinner.esm-6c0927c0.js";import{I as i}from"./inputswitch.esm-294ccfc1.js";import{d as z}from"./index-f687431b.js";import{T as P}from"./toast.esm-8381782e.js";import"./iconbase.esm-c62f15b0.js";import"./index.esm-e44f5f68.js";import"./ripple.esm-79db3f70.js";import"./tooltip.esm-0f28f899.js";import"./csstransition.esm-09727ec9.js";import"./index.esm-366dce1b.js";import"./index.esm-c60f89d0.js";const L=({identyCotizacion:h=1,vistaPreviaExcel:c=!1,setVistaPreviaExcel:g})=>{const n=s.useRef(null),[m,j]=s.useState(!1),[a,d]=s.useState(!1),[r,f]=s.useState(!1),[l,x]=s.useState(!1),[k,u]=s.useState(null),[p,o]=s.useState(!1);s.useEffect(()=>{u(null),o(!1),b(),j(c)},[c]);const b=()=>{d(!1),f(!1),x(!1)},N=()=>{u(null),o(!0);const t=`${route("exportar.excel.cotizacion")}?id=${h}&encabezado=${a}&pie-pagina=${r}&firma=${l}`;setTimeout(()=>{n.current.show({severity:"success",summary:"Exito",detail:"Excel Descargado Correctamente"}),z.Inertia.visit(t,{method:"get"}),o(!1)},1e3)};return e.jsxs(S,{header:"Descargar Excel CotizaciÃ³n",visible:m,maximizable:!0,style:{width:"50vw"},onHide:()=>{m&&g(!1)},children:[e.jsxs("div",{className:"card flex flex-wrap gap-4 p-fluid",children:[e.jsxs("div",{className:"flex-auto text-center",children:[e.jsx("label",{htmlFor:"mile",className:"font-bold block mb-2",children:"Agregar encabezados"}),e.jsx(i,{checked:a,onChange:t=>d(t.value)})," ",e.jsx("span",{children:a?"SI":"NO"})]}),e.jsxs("div",{className:"flex-auto text-center",children:[e.jsx("label",{htmlFor:"percent",className:"font-bold block mb-2",children:"Agregar Pie de Pagina"}),e.jsx(i,{checked:r,onChange:t=>f(t.value)}),r?"SI":"NO"]}),e.jsxs("div",{className:"flex-auto text-center",children:[e.jsx("label",{htmlFor:"expiry",className:"font-bold block mb-2",children:"Agregar Firma"}),e.jsx(i,{checked:l,onChange:t=>x(t.value)}),l?"SI":"NO"]}),e.jsx("div",{className:"flex-auto",children:e.jsx(v,{label:"Desgar Excel",iconPos:"right",onClick:()=>N(),disabled:p})})]}),p&&e.jsx("div",{className:"flex justify-content-center",children:e.jsx(E,{})}),e.jsx("div",{className:" flex justify-content-center",children:e.jsx(P,{ref:n,position:"top-left"})})]})};export{L as default};
//# sourceMappingURL=ExcelPersonalizador-d7cfae54.js.map
