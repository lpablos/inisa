{"version":3,"file":"BusquedaConceptos-a4d79f04.js","sources":["../../../resources/js/Pages/Cotizaciones/partials/BusquedaConceptos.jsx"],"sourcesContent":["import React, { Component, useState } from 'react';\nimport { Button } from 'primereact/button';\nimport { Dialog } from 'primereact/dialog';\nimport TableConceptosGral from './TableConceptosGral';\nimport { InputText } from \"primereact/inputtext\";\nimport { ProgressSpinner } from 'primereact/progressspinner';\nimport axios from \"axios\";\nimport { Dropdown } from 'primereact/dropdown';\nimport { useEffect } from 'react';\n        \n\nconst BusquedaConceptos = ({cotizacion, setReloadList}) => {\n    const [visible, setVisible] = useState(false);\n    const [concepto, setConcepto] = useState('');\n    \n    const [loader, setLoader] = useState(false);\n    const [registros, setRegistros]= useState([])\n    const [numeroRegistros, setNumeroRegistros]= useState(0)\n    const [error, setError] = useState(\"\");\n    const [identyCotizacion, setIdentyCotizacion] = useState(null);  \n    \n    const [tpAsoTomo, setTpAsoTomo] = useState([\n        { name: 'Ninguno', value:0 },\n        { name: 'Captura Tomo', value:1 },\n        { name: 'Listar Tomos', value:2}\n    ]);\n    const [listaTomos, setListaTomo] = useState([]);  \n    \n    const [perteneceTomo, setPerteneceTomo] = useState(0);\n    const [capturaTomo, setCapturaTomo] = useState('');\n    const [seleccionTomo, setSeleccionTomo] = useState(null);\n\n    const validacionCaracteres = (event) =>{\n        const value = event.target.value;\n        setConcepto(value);\n        if (value.length < 10) {\n          setError(\"El concepto debe tener al menos 15 caracteres.\");\n        } else {\n          setError(\"\"); // Limpiar el mensaje de error si es válido\n        }\n    }\n\n    const busquedaGeneralConcepto = async () =>{\n        setLoader(true)\n        setTimeout(() => {\n            setLoader(false)\n        }, 2000);\n        try {\n            const response = await axios.post(`${route(\"buscador.general.concepto\")}`,{'concepto':concepto});\n            if (response.status === 200) {\n                \n                const {data, mensaje, registros} = response.data\n                setRegistros(data)\n                setNumeroRegistros(registros);\n            }            \n        } catch (error) {\n            console.log(\"Este dato \", error);            \n            alert(\"Error\")\n        }\n    }\n    // buscador.general.concepto\n    const getListadoTomoAsc = async() =>{\n        await axios\n        .get(`${route(\"cotizacion.list.tomos\", { identy: identyCotizacion })}`)\n        .then((response) => {\n            const {data, status } = response       \n            if(status == 200){\n                const dataMapeada = data.map(item => ({\n                    id: item.id,\n                    name: item.PDA + ' - ' + item.descripcion\n                }));\n                setListaTomo(dataMapeada)\n            }\n        });\n    }\n\n    const validacionConcepto = (dato) => {\n        alert(\"Validacion\")\n        console.log('Evento recibido del hijo:', dato);\n        // Realiza aquí las acciones que necesites\n    };\n\n    useEffect(()=>{\n        if(visible){\n            getListadoTomoAsc()\n        }\n    },[visible])\n\n    useEffect(()=>{\n        setIdentyCotizacion(cotizacion)\n    },[cotizacion])\n\n    return (\n        <>\n            <Button className='mr-1' icon=\"pi pi-search\" rounded aria-label=\"Search\" tooltip=\"Busqueda Conceptos\" tooltipOptions={{ position: 'left' }} onClick={() => setVisible(true)}/>\n            {/* <Button label=\"Show\" icon=\"pi pi-external-link\" onClick={() => setVisible(true)} /> */}\n            <Dialog header=\"Busqueda de Conceptos\" visible={visible} maximizable style={{ width: '80vw' }} onHide={() => {if (!visible) return; setVisible(false); }}>\n\n                <div class=\"formgrid grid\">\n                    <div class=\"field col-3\">\n                        <label htmlFor=\"defineTomo\" className=\"font-bold block mb-2\">Definición de Tomo</label>\n                        <Dropdown value={perteneceTomo} onChange={(e) => setPerteneceTomo(e.value)} options={tpAsoTomo} optionLabel=\"name\" editable placeholder=\"Selecione un tomo\" className=\"w-full md:w-14rem\" />\n                    </div>\n                    <div class=\"field col-9\">\n                        {(perteneceTomo == 1) && (\n                            <>\n                                <label htmlFor=\"mile\" className=\"font-bold block mb-2\">Captura un Tomo</label>\n                                <InputText value={capturaTomo} onChange={(e) => setCapturaTomo(e.target.value)} className=\"w-full\"/>\n                            </>                 \n                        )}\n                        {(perteneceTomo==2) &&(\n                            <>\n                                <label htmlFor=\"selectTomo\" className=\"font-bold block mb-2\">Selecciona un Tomo</label>\n                                <Dropdown \n                                    value={seleccionTomo} \n                                    onChange={(e) => setSeleccionTomo(e.value)} \n                                    options={listaTomos} \n                                    optionLabel=\"name\" \n                                    editable\n                                    placeholder=\"Seleccione\" \n                                    className=\"w-full\" />\n                            </>  \n                        )}\n                    </div>\n                </div>\n\n                <div className=\"flex justify-content-center m-4\">\n                    <div className=\"p-inputgroup flex-1\">\n                        <InputText placeholder=\"Captura el concepto a buscar\" className=\"p-inputtext-lg\" value={concepto} onChange={((event)=>validacionCaracteres(event))}/>\n                        <Button icon=\"pi pi-search\" onClick={()=>busquedaGeneralConcepto()} disabled={concepto.length < 10} />\n                    </div> \n                </div>\n                {error && (\n                    <div className=\"flex justify-content-center m-4\">\n                        <div className=\"p-inputgroup flex-1\">\n                            <small style={{ color: \"red\" }}>{error}</small>     \n                        </div> \n                    </div>\n                )}\n\n                \n                {loader && (\n                    <div className=\"flex justify-content-center m-4\">\n                        <ProgressSpinner style={{width: '50px', height: '50px'}} strokeWidth=\"8\" fill=\"var(--surface-ground)\" animationDuration=\".5s\" />\n                    </div>\n                )}\n                {loader == false && registros.length > 0 &&(\n                    <TableConceptosGral \n                        listadoConceptos={registros} \n                        totalesAsc={numeroRegistros} \n                        seleccionTomo={seleccionTomo}\n                        perteneceTomo={perteneceTomo}\n                        capturaTomo={capturaTomo}\n                        identyCotizacion={identyCotizacion}\n                        setReloadList={setReloadList}\n                        setRegistros={setRegistros}\n                        \n                        validacionConcepto={validacionConcepto}\n                        setVisibleModal={setVisible}\n                        setConceptoInput={setConcepto}\n                    />\n                )}\n            </Dialog>\n        </>\n        \n    );\n    \n}\n\nexport default BusquedaConceptos;"],"names":["BusquedaConceptos","cotizacion","setReloadList","visible","setVisible","useState","concepto","setConcepto","loader","setLoader","registros","setRegistros","numeroRegistros","setNumeroRegistros","error","setError","identyCotizacion","setIdentyCotizacion","tpAsoTomo","setTpAsoTomo","listaTomos","setListaTomo","perteneceTomo","setPerteneceTomo","capturaTomo","setCapturaTomo","seleccionTomo","setSeleccionTomo","validacionCaracteres","event","value","busquedaGeneralConcepto","response","axios","data","mensaje","getListadoTomoAsc","status","dataMapeada","item","validacionConcepto","dato","useEffect","jsxs","Fragment","jsx","Button","Dialog","Dropdown","e","InputText","ProgressSpinner","TableConceptosGral"],"mappings":"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"}