{"version":3,"file":"TablaClientes-e9080251.js","sources":["../../../resources/js/Pages/Catalogos/Partials/TablaClientes.jsx"],"sourcesContent":["import React, { Component, useEffect, useState, useRef} from 'react';\nimport { DataTable } from 'primereact/datatable';\nimport { Column } from 'primereact/column';\nimport { Button } from 'primereact/button';\nimport NewClienteDialog from './NewClienteDialog';\nimport { Toast } from 'primereact/toast';\nimport { ProgressSpinner } from 'primereact/progressspinner';\nimport { Message } from 'primereact/message';\nimport { ConfirmDialog, confirmDialog } from 'primereact/confirmdialog';\nimport axios from 'axios';\n\nconst TablaClientes = () => {\n    \n    const toast = useRef(null);\n    \n    const [catClientes, setCatClientes] = useState([]);\n    const [loading, setLoading] = useState(false)\n    const [mostrarModal, setMostrarModal] = useState(false);\n    const [registroEdicion, setRegistroEdicion] = useState(null); // Detalle del registro\n\n    const obtenerCatClientes = async () =>{\n        setLoading(true)\n        try {\n            setTimeout( async() => {\n                const response = await axios.get(route(\"catalogos.listado.clientes.empresa\"));            \n                const {data,status }= response\n                if(status == 200){\n                    const listadoClientes = data.map( item =>({\n                        id: item.id,\n                        nombre: item.abreviacion+' - '+item.nombre,\n                        numeroProvedor: item.numeroProvedor || '',\n                        email: item.email ||'',\n                        telefono: item.telefono || ''\n                    }))\n                    setCatClientes(listadoClientes)\n                    setLoading(false)\n                }                \n            }, 800);            \n            \n        } catch (error) {\n            setLoading(false)\n            console.error(error);\n            toast.current.show({\n                severity: \"error\",\n                summary: \"Error\",\n                detail: \"No se logro cargar el Catalogo de Clientes\",\n                life: 3000,\n            });\n        }\n    }\n    const editarRegistro = async (registro) =>{\n        \n        try {            \n            const response = await axios.get(route(\"catalogos.detalle.cliente.asc\", { id: registro }));  \n            const {status, data} = response\n            if(status === 200){\n                setRegistroEdicion(data);\n                setMostrarModal(true);\n            }\n        } catch (error) {\n            toast.current.show({\n                severity: \"error\",\n                summary: \"Error\",\n                detail: \"No se pudo obtener la lista de clientes.\",\n                life: 3000,\n            });\n        }\n    }\n\n    const confirmEliminar = (row) => {\n        \n        confirmDialog({\n            message: `¿Estas seguro de eliminar a : ${row.nombre} ?`,\n            header: 'Confirmacion de Eliminar',\n            icon: 'pi pi-info-circle',\n            defaultFocus: 'reject',\n            acceptClassName: 'p-button-danger',\n            accept:() => acceptEliminar(row.id),\n            reject:() => cancelarEliminar()\n        });\n    };\n\n    const acceptEliminar = async (identy) => {\n\n        setLoading(true);\n        try {\n            setTimeout(async() => {\n                const response = await axios.delete(`${route(\"catalogo.eliminar.cliente\", { id: identy })}`);\n                const {data,status }= response\n                if(status===200){\n                    toast.current.show({\n                        severity: \"success\",\n                        summary: \"Registro Eliminado\",\n                        detail: \"Cliente Eliminado Correctamente\",\n                        life: 3000,\n                    });\n                    setLoading(false);\n                    obtenerCatClientes()\n                }                \n            }, 800);\n            \n        } catch (error) {\n            toast.current.show({\n                severity: \"error\",\n                summary: \"Error\",\n                detail: \"No se pudo eliminar el cliente.\",\n                life: 3000,\n            });\n            setLoading(false);\n        }\n        \n    }\n\n    const cancelarEliminar = () => {\n        toast.current.show({ severity: 'warn', summary: 'Sin Detalle', detail: 'No se modifico ningun registro', life: 3000 });\n    }\n\n\n    useEffect(()=>{\n        obtenerCatClientes()\n    },[]);\n\n    const opcionesAsc = (rowData) => {\n        \n        return (\n            <div className=\"flex flex-wrap justify-content-center gap-1 mb-4\">\n                <Button icon=\"pi pi-eye\" rounded severity=\"info\" aria-label=\"User\" onClick={() => editarRegistro(rowData.id)}  />\n                <Button icon=\"pi pi-times\" rounded severity=\"danger\" aria-label=\"Cancel\" onClick={()=>confirmEliminar(rowData)} tooltip=\"Eliminar\" tooltipOptions={{ position: 'left' }}/>\n            </div>\n        );\n    };\n    return (\n        <div className=\"row\">\n            \n            <div className=\"col-12 text-right\">\n                <Button icon=\"pi pi-history\" rounded severity=\"help\" aria-label=\"Regresar Cotizaciones\"  tooltip=\"Regresar Cotizaciones\" tooltipOptions={{ position: 'left' }} onClick={() => window.location.href = route('catalogo.gral.index')}/>\n            </div>\n            <NewClienteDialog reloadRegistros={obtenerCatClientes} mostrarModal={mostrarModal} setMostrarModal={setMostrarModal} registro={registroEdicion} />\n            <div className=\"card\">\n                {loading && (\n                    <div className=\"flex justify-content-center\">\n                        <ProgressSpinner />\n                    </div>\n                )}\n                {loading === false && catClientes.length > 0 && (\n                    <DataTable value={catClientes} tableStyle={{ minWidth: '50rem' }}>\n                        <Column field=\"nombre\" header=\"Nombre\"></Column>\n                        <Column field=\"numeroProvedor\" header=\"Num. Provedor\"></Column>\n                        <Column field=\"email\" header=\"Correo\"></Column>\n                        <Column field=\"telefono\" header=\"Teléfono\"></Column>\n                        <Column field=\"opciones\" header=\"Opciones\" body={opcionesAsc} ></Column>\n                    </DataTable>\n                )}\n                {loading === false && catClientes.length === 0 && (\n                    <Message severity=\"info\" text=\"No existen registros suficientes\" />\n                )}\n            </div>\n            <Toast ref={toast} />\n            \n            <ConfirmDialog />\n        </div>\n    \n    );\n    \n}\n\nexport default TablaClientes;"],"names":["TablaClientes","toast","useRef","catClientes","setCatClientes","useState","loading","setLoading","mostrarModal","setMostrarModal","registroEdicion","setRegistroEdicion","obtenerCatClientes","response","axios","data","status","listadoClientes","item","error","editarRegistro","registro","confirmEliminar","row","confirmDialog","acceptEliminar","cancelarEliminar","identy","useEffect","opcionesAsc","rowData","jsxs","jsx","Button","NewClienteDialog","ProgressSpinner","DataTable","Column","Message","Toast","ConfirmDialog"],"mappings":"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"}