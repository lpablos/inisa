{"version":3,"file":"TableConceptosGral-d2fb52e7.js","sources":["../../../resources/js/Pages/LogsActividades/partials/TableConceptosGral.jsx"],"sourcesContent":["import React, { Component, useState, useEffect, useRef } from 'react';\n\nimport { DataTable } from 'primereact/datatable';\nimport { Column } from 'primereact/column';\nimport { SelectButton } from 'primereact/selectbutton';\nimport { Dropdown } from 'primereact/dropdown';\nimport { ConfirmPopup, confirmPopup } from 'primereact/confirmpopup';\nimport axios from \"axios\";\nimport { ConfirmDialog, confirmDialog } from 'primereact/confirmdialog';\nimport { Toast } from 'primereact/toast';\nimport { Button } from 'primereact/button';\nimport DOMPurify from \"dompurify\";\n\nconst TableConceptosGral = ({listadoConceptos = [], totalesAsc=0,seleccionTomo,perteneceTomo,capturaTomo,identyCotizacion, setVisibleModal, setConceptoInput, setReloadList, setRegistros}) => {\n    const [conceptos, setConceptos] = useState([]);\n    const [totales, setTotales] = useState([]);\n    const [visible, setVisible] = useState(false);\n    const toast = useRef(null);\n    \n    const [selecTomo, setSelecTomo] = useState(null);\n    const [pertTomo, setPertTomo] = useState(null);\n    const [captTomo, setCaptTomo] = useState(null);\n    const [idConcepto, setIdConcepto] = useState(null)\n    const [idCotiza, setIdCotiza] = useState(null)\n    // const []\n    \n   \n    useEffect(() => {\n        setConceptos(listadoConceptos)\n        setTotales(totalesAsc)\n    }, [listadoConceptos]);\n    \n    useEffect(()=>{\n        setSelecTomo(seleccionTomo)\n        setPertTomo(perteneceTomo)\n        setCaptTomo(capturaTomo)\n        setIdCotiza(identyCotizacion)\n    },[seleccionTomo,perteneceTomo,capturaTomo, identyCotizacion])\n\n    const validacionConcepto = (dato) =>{\n        const{id}= dato;\n        setIdConcepto(id);\n        setVisible(true)\n    }\n\n    const resetForm = () =>{\n        setConceptoInput('')\n        setConceptos([])\n        setRegistros([])\n    }\n\n    const asociarConcepto = async () =>{\n        try {\n            const datos = {\n                'identyCotizacion' : idCotiza,\n                'identyConcepto' : idConcepto,\n                'selecTomo' : selecTomo,\n                'pertTomo' : pertTomo,\n                'captTomo' : captTomo,\n            }\n            const response = await axios.post(  `${route(\"asociar.concepto.generales\")}`,datos)\n            const {data,success} = response.data\n            if(response.status == 201){\n                resetForm()\n                setReloadList(true)\n                toast.current.show({ severity: 'info', summary: 'Confirmed', detail:  `${success}`, life: 3000 });\n                setTimeout(() => {\n                    setVisibleModal(false);    \n                }, 3500);\n            }\n            console.log(\"Esta es la respues\", response);\n            \n        } catch (error) {\n            // console.log(\"Este es el errror\", error);\n            \n            alert(\"Error\")\n        }\n    }\n\n    const accept = () => {\n        asociarConcepto()\n        // resetForm()\n        // toast.current.show({ severity: 'info', summary: 'Confirmed', detail: 'You have accepted', life: 3000 });\n        // setTimeout(() => {\n        //     setVisibleModal(false);    \n        // }, 3500);\n\n    };\n    const reject = () => {\n        toast.current.show({ severity: 'warn', summary: 'Rejected', detail: 'You have rejected', life: 3000 });\n    };\n\n    const accionesTemplate = (rowData) => (\n        <div className=\"flex gap-2\">\n            <Button\n                severity=\"success\"\n                size=\"small\"\n                icon=\"pi pi-check-circle\"\n                tooltip=\"Agregar\"\n                tooltipOptions={{ position: \"bottom\", showDelay: 200, hideDelay: 300 }}\n                className=\"p-button-rounded p-button-info p-button-sm\"\n                onClick={() => validacionConcepto(rowData) }\n            />\n        </div>\n    );\n\n    const detalleMaterial = (rowData)=>{\n        return (\n            <ul>\n                {rowData.costo_material_cantidad && (\n                    <li>\n                    <strong>Cantidad:</strong> {rowData.costo_material_cantidad}\n                    </li>\n                )}\n                {rowData.costo_material_unitario_sugerido && (\n                    <li>\n                    <strong>Costo Sugerido:</strong> {rowData.costo_material_unitario_sugerido.toFixed(2)} {rowData.moneda}\n                    </li>\n                )}\n                {rowData.costo_material_unitario && (\n                    <li>\n                    <strong>Costo:</strong> {rowData.costo_material_unitario.toFixed(2)} {rowData.moneda}\n                    </li>\n                )}\n                {rowData.costo_material_subtotal && (\n                    <li>\n                    <strong>Costo Subtotal:</strong> {rowData.costo_material_subtotal.toFixed(2)} {rowData.moneda}\n                    </li>\n                )}\n            </ul>\n        );\n    }\n    const detalleManoObra = (rowData)=>{\n        return (\n            <ul>\n                {rowData.costo_mano_obra_unitario_sugerido && (\n                    <li>\n                    <strong>Costo Unitario Sugerido:</strong> {rowData.costo_mano_obra_unitario_sugerido.toFixed(2)} {rowData.moneda}\n                    </li>\n                )}\n                {rowData.costo_mano_obra_unitario && (\n                    <li>\n                    <strong>Costo Unitario:</strong> {rowData.costo_mano_obra_unitario.toFixed(2)} {rowData.moneda}\n                    </li>\n                )}\n                {rowData.costo_mano_obra_unitario_sugerido && (\n                    <li>\n                    <strong>Subtotal:</strong> {rowData.costo_mano_obra_unitario_sugerido.toFixed(2)} {rowData.moneda}\n                    </li>\n                )}\n                {rowData.obra_material_subtotal && (\n                    <li>\n                    <strong>M.O./MATER. Subtotal:</strong> {rowData.obra_material_subtotal.toFixed(2)} {rowData.moneda}\n                    </li>\n                )}\n            </ul>\n        );\n    }\n\n    const detalleDescripcion = (rowData)=>{\n        return (\n            <div dangerouslySetInnerHTML={{ __html: DOMPurify.sanitize(rowData.descripcion) }} />\n        );\n    }\n    return (\n        <>\n            <div className=\"card\">\n                <DataTable value={conceptos} size={'small'} paginator rows={5}>\n                    {/* <Column field=\"descripcion\" header=\"Descripción\"  style={{ width: '50%' }}></Column> */}\n                    <Column field=\"descripcion\" header=\"Descripción\"  style={{ width: '50%' }} body={detalleDescripcion}></Column>\n                    <Column field=\"name\" header=\"Material\" body={detalleMaterial}></Column>\n                    <Column field=\"category\" header=\"Mano de Obra\" body={detalleManoObra}></Column>\n                    <Column field=\"opciones\" header=\"Opción\" body={accionesTemplate}></Column>\n                </DataTable>\n                <Toast ref={toast} />\n                <ConfirmDialog\n                    group=\"declarative\"\n                    visible={visible}\n                    onHide={() => setVisible(false)}\n                    message=\"¿Estas seguro de agregar este concepto?\"\n                    header=\"Confirmación\"\n                    icon=\"pi pi-exclamation-triangle\"\n                    accept={accept}\n                    reject={reject}\n                    breakpoints={{ '1100px': '75vw', '960px': '100vw' }}\n                />\n            </div>\n        </>\n        \n            \n        \n    );\n    \n}\n\nexport default TableConceptosGral;"],"names":["TableConceptosGral","listadoConceptos","totalesAsc","seleccionTomo","perteneceTomo","capturaTomo","identyCotizacion","setVisibleModal","setConceptoInput","setReloadList","setRegistros","conceptos","setConceptos","useState","totales","setTotales","visible","setVisible","toast","useRef","selecTomo","setSelecTomo","pertTomo","setPertTomo","captTomo","setCaptTomo","idConcepto","setIdConcepto","idCotiza","setIdCotiza","useEffect","validacionConcepto","dato","id","resetForm","asociarConcepto","datos","response","axios","data","success","accept","reject","accionesTemplate","rowData","jsx","Button","detalleMaterial","jsxs","detalleManoObra","detalleDescripcion","DOMPurify","Fragment","DataTable","Column","Toast","ConfirmDialog"],"mappings":"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"}