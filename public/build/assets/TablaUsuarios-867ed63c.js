import{r as i,j as e}from"./app-5cafe52a.js";import{P as w}from"./progressspinner.esm-a1904699.js";import{M as U}from"./message.esm-fb78f01d.js";import{T as R}from"./toast.esm-c4878fe6.js";import{C as S,c as T}from"./confirmdialog.esm-5639a01b.js";import{D,C as m}from"./column.esm-7dd01f34.js";import M from"./NewUsuarioDialog-870154c0.js";import{B as f}from"./button.esm-1465432c.js";import"./ripple.esm-820e5f58.js";import"./index.esm-315bd3cc.js";import"./index.esm-c5fdb121.js";import"./tooltip.esm-ed724f73.js";import"./dialog.esm-e40c1965.js";import"./overlayservice.esm-c6d6d6cf.js";import"./inputnumber.esm-4c61a45b.js";import"./index.esm-c558f97d.js";import"./inputtext.esm-d107091e.js";import"./index.esm-a2057ab8.js";import"./dropdown.esm-6a8fe11a.js";import"./index.esm-158c931f.js";import"./index.esm-6a647233.js";import"./index.esm-0fdc5dfc.js";import"./fieldset.esm-477f3336.js";const se=()=>{const t=i.useRef(null),[d,o]=i.useState(!1),[n,g]=i.useState([]),[x,p]=i.useState(!1),[y,j]=i.useState(null);i.useEffect(()=>{u()},[]);const u=async()=>{o(!0);try{setTimeout(async()=>{const s=await axios.get(route("listado.catalogos.detalle.usuarios")),{data:r,status:l}=s;if(l==200){const a=r.map(c=>({id:c.id,nombre:c.name,email:c.email||"",rol:c.roles[0].name||""}));g(a),o(!1)}},800)}catch{o(!1),t.current.show({severity:"error",summary:"Error",detail:"No se logro cargar el Catalogo de Clientes",life:3e3})}},h=s=>e.jsxs("div",{className:"flex flex-wrap justify-content-center gap-1 mb-4",children:[e.jsx(f,{icon:"pi pi-eye",rounded:!0,severity:"info","aria-label":"User",onClick:()=>E(s.id)}),e.jsx(f,{icon:"pi pi-times",rounded:!0,severity:"danger","aria-label":"Cancel",onClick:()=>C(s),tooltip:"Eliminar",tooltipOptions:{position:"left"}})]}),E=async s=>{try{const r=await axios.get(route("catalogos.detalle.usuario.asc",{id:s})),{status:l,data:a}=r;l===200&&(j(a),p(!0))}catch{t.current.show({severity:"error",summary:"Error",detail:"No se pudo obtener la lista de Usuarios.",life:3e3})}},C=s=>{T({message:`Â¿Estas seguro de eliminar a : ${s.nombre} ?`,header:"Confirmacion de Eliminar",icon:"pi pi-info-circle",defaultFocus:"reject",acceptClassName:"p-button-danger",accept:()=>b(s.id),reject:()=>v()})},b=async s=>{o(!0);try{setTimeout(async()=>{const r=await axios.delete(`${route("eliminar.usuario.registro",{id:s})}`);console.log("Este es el response",r);const{data:l,status:a}=r;a===200&&(t.current.show({severity:"success",summary:"Registro Eliminado",detail:"Cliente Eliminado Correctamente",life:3e3}),o(!1),u())},800)}catch{t.current.show({severity:"error",summary:"Error",detail:"No se pudo eliminar el cliente.",life:3e3}),o(!1)}},v=()=>{t.current.show({severity:"warn",summary:"Sin Detalle",detail:"No se modifico ningun registro",life:3e3})},N=()=>{setTimeout(()=>{u()},700)};return e.jsxs("div",{className:"col-12",children:[e.jsx(M,{reloadRegistros:N,mostrarModal:x,setMostrarModal:p,registro:y}),e.jsxs("div",{className:"card",children:[d&&e.jsx("div",{className:"flex justify-content-center",children:e.jsx(w,{})}),n.length,d===!1&&n.length>0&&e.jsxs(D,{value:n,tableStyle:{minWidth:"50rem"},children:[e.jsx(m,{field:"nombre",header:"Nombre"}),e.jsx(m,{field:"email",header:"Correo"}),e.jsx(m,{field:"rol",header:"Rol"}),e.jsx(m,{field:"opciones",header:"Opciones",body:h})]}),d===!1&&n.length===0&&e.jsx("div",{className:"flex justify-content-center",children:e.jsx(U,{severity:"info",text:"No existen registros suficientes"})})]}),e.jsx(R,{ref:t}),e.jsx(S,{})]})};export{se as default};
