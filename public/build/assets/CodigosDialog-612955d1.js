import{r as o,a as f,j as e}from"./app-f5b48f30.js";import{D as Y}from"./dialog.esm-1c04613c.js";import{B as p}from"./button.esm-9f4ba889.js";import{I as A}from"./inputtext.esm-c0ceb7aa.js";import{C as Z}from"./calendar.esm-a8385e10.js";import{D as _,C as g}from"./column.esm-593338c3.js";import{T as ee}from"./toast.esm-b606329d.js";import{C as te,c as E}from"./confirmdialog.esm-41bad574.js";import{P as se}from"./progressspinner.esm-5fc3a8a1.js";import"./iconbase.esm-a910649f.js";import"./csstransition.esm-678c9b82.js";import"./index.esm-a2a5ba18.js";import"./tooltip.esm-f1d08006.js";import"./ripple.esm-32b7924c.js";import"./index.esm-88cead70.js";import"./overlayservice.esm-5e43e3fd.js";import"./index.esm-1cd2ea59.js";import"./index.esm-5803aef1.js";import"./inputnumber.esm-ea175f00.js";import"./index.esm-496ddd78.js";import"./index.esm-6f8d2466.js";import"./dropdown.esm-794b1ea8.js";import"./virtualscroller.esm-13f4a162.js";import"./index.esm-59c9c344.js";import"./index.esm-a92504dd.js";import"./index.esm-4170995c.js";const Ie=({seleccionCotizacion:N,codigosShow:D,setCodigosShow:R})=>{const[l,s]=o.useState(!1),r=o.useRef(null),[d,S]=o.useState(!1),[F,I]=o.useState(null),[h,y]=o.useState(""),[x,j]=o.useState(""),[v,C]=o.useState(null),[T,O]=o.useState([]),a=o.useRef(!1),[b,$]=o.useState(null),[k,n]=o.useState(!0);o.useEffect(()=>{S(D),m(),n(!0)},[D]),o.useEffect(()=>{$(N)},[N]),o.useEffect(()=>{d&&u()},[d]);const B=()=>{Q()},L=()=>{r.current.show({severity:"warn",summary:"Sin efecto",detail:"Intenta con otros valores",life:3e3})},P=()=>{a.current||(a.current=!0,E({message:"¿Estas seguro de continuar?",header:"Confirmación",icon:"pi pi-exclamation-triangle",defaultFocus:"accept",accept:()=>{B(),a.current=!1},reject:()=>{L(),a.current=!1}}))},q=()=>{a.current||(a.current=!0,E({message:"¿Estas seguro de editar el registro?",header:"Confirmación",icon:"pi pi-exclamation-triangle",defaultFocus:"accept",accept:()=>{H(),a.current=!1},reject:()=>{M(),a.current=!1}}))},H=()=>{J()},M=()=>{r.current.show({severity:"warn",summary:"Sin efecto",detail:"Intenta con otros valores",life:3e3})},V=t=>{K(t)},W=()=>{r.current.show({severity:"warn",summary:"Sin efecto",detail:"Intenta con otros valores",life:3e3})},G=t=>{const{id:i,codigo:c,descripcion:w,fecha:z}=t;console.log("Esto entra ",t.id),!a.current&&(a.current=!0,E({message:`¿Estas seguro de eliminar "${c}"?`,header:"Confirmación",icon:"pi pi-exclamation-triangle",defaultFocus:"accept",accept:()=>{V(i),a.current=!1},reject:()=>{W(),a.current=!1}}))},J=async()=>{s(!0);try{const t=F,i={identyCod:F,codigo:h,descripcion:x,fecha:v,identyCotizacion:b};(await f.put(`${route("codigo.actualiza.asociado.identy",{id:t})}`,i)).status===200&&(r.current.show({severity:"success",summary:"Registro Actualizado",detail:"Código Actualizado Correctamene",life:3e3}),s(!1),m(),u(),n(!0))}catch{r.current.show({severity:"error",summary:"Error",detail:"Error al guarda, Intenta mas tarde",life:3e3}),s(!1),n(!0)}},K=async t=>{s(!0);try{(await f.delete(`${route("codigo.delete.asociado.identy",{id:t})}`)).status===200&&(r.current.show({severity:"success",summary:"Código Eliminado",detail:"Código Asociado Eliminado Correctamene",life:3e3}),s(!1),m(),u(),n(!0))}catch{r.current.show({severity:"error",summary:"Error",detail:"Error al guarda, Intenta mas tarde",life:3e3}),s(!1)}},Q=async()=>{s(!0);try{const t={codigo:h,descripcion:x,fecha:v,identyCotizacion:b};(await f.post(route("cotiacion.codigos.nuevo"),t)).status===201&&(r.current.show({severity:"success",summary:"Nuevo Registro",detail:"Código Asociado Correctamene",life:3e3}),s(!1),m(),u())}catch{r.current.show({severity:"error",summary:"Error",detail:"Error al guarda, Intenta mas tarde",life:3e3}),s(!1)}},u=async()=>{s(!0);try{const t=b,i=await f.get(route("codigos.asociados.cotizacion",{identy:t}));if(i.status===200){const{data:c,success:w}=i.data;O(c),s(!1)}}catch{r.current.show({severity:"error",summary:"Error",detail:"Error al listar los datos, Intenta mas tarde",life:3e3}),s(!1)}},m=()=>{y(""),j(""),I(null),C(null)},U=t=>{s(!0),n(!1),setTimeout(()=>{s(!1);const{codigo:i,descripcion:c,fecha:w,id:z}=t;I(z),y(i),j(c),C(new Date(w)||null),r.current.show({severity:"info",summary:"Detalle",detail:"Se cargo el detalle en el formulario",life:3e3})},1e3)},X=t=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{severity:"danger",size:"small",icon:"pi pi-trash",tooltip:"Eliminar",tooltipOptions:{position:"bottom",showDelay:200,hideDelay:300},className:"p-button-rounded p-button-info p-button-sm",onClick:()=>G(t)}),e.jsx(p,{severity:"success",size:"small",icon:"pi pi-refresh",tooltip:"Actualizar",tooltipOptions:{position:"bottom",showDelay:200,hideDelay:300},className:"p-button-rounded p-button-info p-button-sm",onClick:()=>U(t)})]});return e.jsxs("div",{className:"flex justify-content-center",children:[e.jsx(ee,{ref:r}),e.jsx(te,{}),e.jsx(Y,{header:"Códigos",visible:d,maximizable:!0,style:{width:"60vw"},onHide:()=>{d&&(S(!1),R(!1))},children:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card flex flex-wrap gap-4 p-fluid",children:[e.jsxs("div",{className:"flex-auto",children:[e.jsx("label",{htmlFor:"integeronly",className:"font-bold block mb-2",children:"Código"}),e.jsx(A,{value:h,onChange:t=>y(t.target.value)})]}),e.jsxs("div",{className:"flex-auto",children:[e.jsx("label",{htmlFor:"withoutgrouping",className:"font-bold block mb-2",children:"Descripción"}),e.jsx(A,{value:x,onChange:t=>j(t.target.value)})]}),e.jsxs("div",{className:"flex-auto",children:[e.jsx("label",{htmlFor:"minmaxfraction",className:"font-bold block mb-2",children:"Fecha"}),e.jsx(Z,{value:v,onChange:t=>C(t.target.value)})]}),l===!1&&k===!0&&e.jsx("div",{className:"flex-auto",children:e.jsx(p,{onClick:P,icon:"pi pi-check",label:"Registrar",className:"mt-4"})}),l===!1&&k===!1&&e.jsx("div",{className:"flex-auto",children:e.jsx(p,{onClick:q,icon:"pi pi-check",label:"Editar",className:"mt-4"})})]}),l===!0&&e.jsx("div",{className:" flex justify-content-center",children:e.jsx(se,{})}),l===!1&&e.jsx("div",{className:"card",children:e.jsxs(_,{value:T,tableStyle:{minWidth:"50rem"},children:[e.jsx(g,{field:"codigo",header:"Codigo"}),e.jsx(g,{field:"descripcion",header:"Descripcion"}),e.jsx(g,{field:"fecha",header:"Fecha"}),e.jsx(g,{field:"quantity",header:"Opciones",body:X})]})})]})})]})};export{Ie as default};
//# sourceMappingURL=CodigosDialog-612955d1.js.map
