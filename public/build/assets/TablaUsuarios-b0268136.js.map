{"version":3,"file":"TablaUsuarios-b0268136.js","sources":["../../../resources/js/Pages/Catalogos/Partials/TablaUsuarios.jsx"],"sourcesContent":["import React, { Component , useState, useRef, useEffect} from 'react';\nimport { ProgressSpinner } from 'primereact/progressspinner';\nimport { Message } from 'primereact/message';\nimport { Toast } from 'primereact/toast';\nimport { ConfirmDialog, confirmDialog } from 'primereact/confirmdialog';\nimport { DataTable } from 'primereact/datatable';\nimport NewUsuarioDialog from './NewUsuarioDialog';\nimport { InputText } from 'primereact/inputtext';\nimport { Fieldset } from 'primereact/fieldset';\nimport { Column } from 'primereact/column';\nimport { Button } from 'primereact/button';\n\nconst TablaUsuarios = () => {\n     const toast = useRef(null);\n    const [loading, setLoading] = useState(false)\n    const [catUsuarios, setCatUsuarios] = useState([]);\n\n    const [mostrarModal, setMostrarModal] = useState(false);\n    const [registroEdicion, setRegistroEdicion] = useState(null); // Detalle del registro\n\n    useEffect(()=>{\n        obtenerCatUsuarios()\n    },[])\n\n    const obtenerCatUsuarios = async () =>{\n        setLoading(true)\n        try {\n            setTimeout( async() => {\n                const response = await axios.get(route(\"listado.catalogos.detalle.usuarios\"));     \n                       \n                const {data,status }= response\n                if(status == 200){\n                    const listadoUsuarios = data.map( item =>({\n                        id: item.id,\n                        nombre: item.name,\n                        email: item.email ||'',\n                        rol: item.roles[0].name || '',\n                        // telefono: item.telefono || ''\n                    }))\n                    \n                    setCatUsuarios(listadoUsuarios)\n                    setLoading(false)\n                }                \n            }, 800);  \n        } catch (error) {\n            setLoading(false)\n            toast.current.show({\n                severity: \"error\",\n                summary: \"Error\",\n                detail: \"No se logro cargar el Catalogo de Clientes\",\n                life: 3000,\n            });\n        }\n    }\n\n    const opcionesAsc = (rowData) => {\n        \n        return (\n            <div className=\"flex flex-wrap justify-content-center gap-1 mb-4\">\n                <Button icon=\"pi pi-eye\" rounded severity=\"info\" aria-label=\"User\" onClick={() => editarRegistro(rowData.id)}  />\n                <Button icon=\"pi pi-times\" rounded severity=\"danger\" aria-label=\"Cancel\" onClick={()=>confirmEliminar(rowData)} tooltip=\"Eliminar\" tooltipOptions={{ position: 'left' }}/>\n            </div>\n        );\n    };\n\n    const editarRegistro = async (registro) =>{\n        \n        try {            \n            const response = await axios.get(route(\"catalogos.detalle.usuario.asc\", { id: registro }));  \n            const {status, data} = response\n            if(status === 200){\n                setRegistroEdicion(data);\n                setMostrarModal(true);\n            }\n        } catch (error) {\n            toast.current.show({\n                severity: \"error\",\n                summary: \"Error\",\n                detail: \"No se pudo obtener la lista de Usuarios.\",\n                life: 3000,\n            });\n        }\n    }\n\n    const confirmEliminar = (row) => {\n            \n        confirmDialog({\n            message: `Â¿Estas seguro de eliminar a : ${row.nombre} ?`,\n            header: 'Confirmacion de Eliminar',\n            icon: 'pi pi-info-circle',\n            defaultFocus: 'reject',\n            acceptClassName: 'p-button-danger',\n            accept:() => acceptEliminar(row.id),\n            reject:() => cancelarEliminar()\n        });\n    };\n\n    const acceptEliminar = async (identy) => {\n        setLoading(true);\n        try {\n            setTimeout(async() => {\n                const response = await axios.delete(`${route(\"eliminar.usuario.registro\", { id: identy })}`);\n                console.log(\"Este es el response\", response);\n                \n                const {data,status }= response\n                if(status===200){\n                    toast.current.show({\n                        severity: \"success\",\n                        summary: \"Registro Eliminado\",\n                        detail: \"Cliente Eliminado Correctamente\",\n                        life: 3000,\n                    });\n                    setLoading(false);\n                    obtenerCatUsuarios()\n                }                \n            }, 800);\n            \n        } catch (error) {\n            toast.current.show({\n                severity: \"error\",\n                summary: \"Error\",\n                detail: \"No se pudo eliminar el cliente.\",\n                life: 3000,\n            });\n            setLoading(false);\n        }\n        \n    }\n\n    const cancelarEliminar = () => {\n        toast.current.show({ severity: 'warn', summary: 'Sin Detalle', detail: 'No se modifico ningun registro', life: 3000 });\n    }\n\n    const recargarListado = () =>{\n        setTimeout(() => {\n            obtenerCatUsuarios();            \n        }, 700);\n    }\n\n\n\n\n\n    return (\n        <div className=\"row\">\n            <div className=\"col-12 text-right\">\n                <Button icon=\"pi pi-history\" rounded severity=\"help\" aria-label=\"Regresar Cotizaciones\"  tooltip=\"Regresar Cotizaciones\" tooltipOptions={{ position: 'left' }} onClick={() => window.location.href = route('catalogo.gral.index')}/>\n            </div>\n            <NewUsuarioDialog reloadRegistros={recargarListado} mostrarModal={mostrarModal} setMostrarModal={setMostrarModal} registro={registroEdicion}/>\n            <div className=\"card\">\n                {loading && (\n                    <div className=\"flex justify-content-center\">\n                        <ProgressSpinner />\n                    </div>\n                )}\n                {loading === false && catUsuarios.length > 0 && (\n                    <DataTable value={catUsuarios} tableStyle={{ minWidth: '50rem' }}>\n                        <Column field=\"nombre\" header=\"Nombre\"></Column>\n                        <Column field=\"email\" header=\"Correo\"></Column>\n                        <Column field=\"rol\" header=\"Rol\"></Column>\n                        <Column field=\"opciones\" header=\"Opciones\" body={opcionesAsc} ></Column>\n                    </DataTable>\n                )}\n                {loading === false && catUsuarios.length === 0 && (\n                    <div className=\"flex justify-content-center\">\n                        <Message severity=\"info\" text=\"No existen registros suficientes\" />\n                    </div>\n                )}\n            </div>\n            <Toast ref={toast} />           \n            <ConfirmDialog />\n        </div>\n    );\n    \n}\n\nexport default TablaUsuarios;"],"names":["TablaUsuarios","toast","useRef","loading","setLoading","useState","catUsuarios","setCatUsuarios","mostrarModal","setMostrarModal","registroEdicion","setRegistroEdicion","useEffect","obtenerCatUsuarios","response","data","status","listadoUsuarios","item","opcionesAsc","rowData","jsxs","jsx","Button","editarRegistro","confirmEliminar","registro","row","confirmDialog","acceptEliminar","cancelarEliminar","identy","recargarListado","NewUsuarioDialog","ProgressSpinner","DataTable","Column","Message","Toast","ConfirmDialog"],"mappings":"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"}