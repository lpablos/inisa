import{O as _,r as m,P as Ae,U as Ie,c as L,I as Oe,D as E,j as o}from"./app-f5b48f30.js";import{C as je,u as De,a as ze,b as _e}from"./iconbase.esm-a910649f.js";import{C as Re}from"./csstransition.esm-678c9b82.js";import{C as He}from"./overlayservice.esm-5e43e3fd.js";import{C as ke}from"./index.esm-1cd2ea59.js";import{C as $e,c as ve}from"./confirmdialog.esm-41bad574.js";import{T as Fe}from"./toast.esm-b606329d.js";import{B as Ke}from"./badge.esm-325b6cb7.js";import{P as Be}from"./column.esm-593338c3.js";import{E as Le}from"./editor.esm-09e9084a.js";import{I as be}from"./inputtext.esm-c0ceb7aa.js";import{D as he}from"./dropdown.esm-794b1ea8.js";import{C as Me}from"./calendar.esm-a8385e10.js";import{B as Z}from"./button.esm-9f4ba889.js";import Ue from"./NuevaActividad-58c7b1cb.js";import qe from"./EliminarMotivo-46d99828.js";import Xe from"./NuevaCotizacion-e69ff077.js";import Je from"./BuscadorCotizacion-94e19873.js";import{S as Ve}from"./splitbutton.esm-67f8e4ae.js";import"./dialog.esm-1c04613c.js";import"./index.esm-a2a5ba18.js";import"./tooltip.esm-f1d08006.js";import"./ripple.esm-32b7924c.js";import"./index.esm-59c9c344.js";import"./index.esm-88cead70.js";import"./inputnumber.esm-ea175f00.js";import"./index.esm-496ddd78.js";import"./index.esm-6f8d2466.js";import"./virtualscroller.esm-13f4a162.js";import"./index.esm-a92504dd.js";import"./index.esm-4170995c.js";import"./index.esm-5803aef1.js";import"./progressspinner.esm-5fc3a8a1.js";import"./fieldset.esm-035fd17f.js";import"./divider.esm-61b20be2.js";function te(){return te=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var p in r)Object.prototype.hasOwnProperty.call(r,p)&&(t[p]=r[p])}return t},te.apply(this,arguments)}function fe(t,a){(a==null||a>t.length)&&(a=t.length);for(var r=0,p=new Array(a);r<a;r++)p[r]=t[r];return p}function We(t){if(Array.isArray(t))return fe(t)}function Ye(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ce(t,a){if(t){if(typeof t=="string")return fe(t,a);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fe(t,a)}}function Ge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qe(t){return We(t)||Ye(t)||Ce(t)||Ge()}function M(t){"@babel/helpers - typeof";return M=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},M(t)}function Ze(t,a){if(M(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var p=r.call(t,a||"default");if(M(p)!=="object")return p;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function et(t){var a=Ze(t,"string");return M(a)==="symbol"?a:String(a)}function tt(t,a,r){return a=et(a),a in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}function at(t){if(Array.isArray(t))return t}function rt(t,a){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var p,f,w,g,b=[],T=!0,A=!1;try{if(w=(r=r.call(t)).next,a===0){if(Object(r)!==r)return;T=!1}else for(;!(T=(p=w.call(r)).done)&&(b.push(p.value),b.length!==a);T=!0);}catch(I){A=!0,f=I}finally{try{if(!T&&r.return!=null&&(g=r.return(),Object(g)!==g))return}finally{if(A)throw f}}return b}}function nt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ge(t,a){return at(t)||rt(t,a)||Ce(t,a)||nt()}var ot={root:"p-accordion p-component",accordiontab:{root:function(a){var r=a.selected;return L("p-accordion-tab",{"p-accordion-tab-active":r})},content:"p-accordion-content",header:function(a){var r=a.selected,p=a.getTabProp,f=a.tab;return L("p-accordion-header",{"p-highlight":r,"p-disabled":p(f,"disabled")})},headeraction:"p-accordion-header-link",headericon:"p-accordion-toggle-icon",headertitle:"p-accordion-header-text",toggleablecontent:"p-toggleable-content",transition:"p-toggleable-content"}},st=`
@layer primereact {
    .p-accordion-header-link {
        cursor: pointer;
        display: flex;
        align-items: center;
        user-select: none;
        position: relative;
        text-decoration: none;
    }
    
    .p-accordion-header-link:focus {
        z-index: 1;
    }
    
    .p-accordion-header-text {
        line-height: 1;
        width: 100%;
    }
}
`,ee=je.extend({defaultProps:{__TYPE:"Accordion",id:null,activeIndex:null,className:null,style:null,multiple:!1,expandIcon:null,collapseIcon:null,transitionOptions:null,onTabOpen:null,onTabClose:null,onTabChange:null,children:void 0},css:{classes:ot,styles:st}}),R=je.extend({defaultProps:{__TYPE:"AccordionTab",className:null,contentClassName:null,contentStyle:null,disabled:!1,header:null,headerClassName:null,headerStyle:null,headerTemplate:null,style:null,tabIndex:0,children:void 0},getCProp:function(a,r){return _.getComponentProp(a,r,R.defaultProps)},getCProps:function(a){return _.getComponentProps(a,R.defaultProps)},getCOtherProps:function(a){return _.getComponentDiffProps(a,R.defaultProps)}});function ye(t,a){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(t);a&&(p=p.filter(function(f){return Object.getOwnPropertyDescriptor(t,f).enumerable})),r.push.apply(r,p)}return r}function z(t){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?ye(Object(r),!0).forEach(function(p){tt(t,p,r[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ye(Object(r)).forEach(function(p){Object.defineProperty(t,p,Object.getOwnPropertyDescriptor(r,p))})}return t}var xe=function(){},Te=m.forwardRef(function(t,a){var r=De(),p=m.useContext(Ae),f=ee.getProps(t,p),w=m.useState(f.id),g=ge(w,2),b=g[0],T=g[1],A=m.useState(f.activeIndex),I=ge(A,2),H=I[0],ae=I[1],P=m.useRef(null),N=f.onTabChange?f.activeIndex:H,k=m.Children.count(f.children),U={props:f,state:{id:b,activeIndex:H}},S=ee.setMetaData(z({},U)),O=S.ptm,re=S.ptmo,y=S.cx,q=S.isUnstyled;ze(ee.css.styles,q,{name:"accordion"});var d=function(e,i){return R.getCProp(e,i)},h=function(e,i,c){var v={parent:U,context:{index:c,count:k,first:c===0,last:c===k-1,selected:K(c),disabled:d(e,"disabled")}};return r(O("tab.".concat(i),{tab:v}),O("accordiontab.".concat(i),{accordiontab:v}),O("accordiontab.".concat(i),v),re(d(e,"pt"),i,v))},ne=function(e,i,c){X(e,i,c)},X=function(e,i,c){if(!d(i,"disabled")){var v=K(c),j=null;if(f.multiple){var C=N||[];j=v?C.filter(function(B){return B!==c}):[].concat(Qe(C),[c])}else j=v?null:c;var x=v?f.onTabClose:f.onTabOpen;x&&x({originalEvent:e,index:c}),f.onTabChange?f.onTabChange({originalEvent:e,index:j}):ae(j)}e.preventDefault()},J=function(e,i,c){switch(e.code){case"ArrowDown":V(e);break;case"ArrowUp":oe(e);break;case"Home":W(e);break;case"End":Y(e);break;case"Enter":case"NumpadEnter":case"Space":se(e,i,c);break}},V=function(e){var i=$(e.target.parentElement.parentElement);i?D(i):W(e),e.preventDefault()},oe=function(e){var i=F(e.target.parentElement.parentElement);i?D(i):Y(e),e.preventDefault()},W=function(e){var i=ie();D(i),e.preventDefault()},Y=function(e){var i=le();D(i),e.preventDefault()},se=function(e,i,c){X(e,i,c),e.preventDefault()},$=function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,c=i?e:e.nextElementSibling,v=E.findSingle(c,'[data-pc-section="header"]');return v?E.getAttribute(v,"data-p-disabled")?$(v.parentElement):E.findSingle(v,'[data-pc-section="headeraction"]'):null},F=function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,c=i?e:e.previousElementSibling,v=E.findSingle(c,'[data-pc-section="header"]');return v?E.getAttribute(v,"data-p-disabled")?F(v.parentElement):E.findSingle(v,'[data-pc-section="headeraction"]'):null},ie=function(){return $(P.current.firstElementChild,!0)},le=function(){return F(P.current.lastElementChild,!0)},D=function(e){e&&E.focus(e)},K=function(e){return f.multiple&&Array.isArray(N)?N&&N.some(function(i){return i===e}):N===e};if(m.useImperativeHandle(a,function(){return{props:f,getElement:function(){return P.current}}}),_e(function(){b||T(Ie())}),!b)return null;var G=function(e,i,c){var v=z(z({},d(e,"style")||{}),d(e,"headerStyle")||{}),j=b+"_header_"+c,C=b+"_content_"+c,x=d(e,"disabled")?-1:d(e,"tabIndex"),B=r({className:y("accordiontab.headertitle")},h(e,"headertitle",c)),Q=R.getCProps(e),ue=d(e,"headerTemplate")?_.getJSXElement(d(e,"headerTemplate"),Q):m.createElement("span",B,_.getJSXElement(d(e,"header"),Q)),me=r({"aria-hidden":"true",className:y("accordiontab.headericon")},h(e,"headericon",c)),Pe=i?f.collapseIcon||m.createElement(He,me):f.expandIcon||m.createElement(ke,me),Ne=Oe.getJSXIcon(Pe,z({},me),{props:f,selected:i}),Se=r({className:L(d(e,"headerClassName"),d(e,"className"),y("accordiontab.header",{selected:i,getTabProp:d,tab:e})),style:v,"data-p-highlight":i,"data-p-disabled":d(e,"disabled")},h(e,"header",c)),Ee=r({id:j,href:"#"+C,className:y("accordiontab.headeraction"),role:"button",tabIndex:x,onClick:function(pe){return ne(pe,e,c)},onKeyDown:function(pe){return J(pe,e,c)},"aria-disabled":d(e,"disabled"),"aria-controls":C,"aria-expanded":i},h(e,"headeraction",c));return m.createElement("div",Se,m.createElement("a",Ee,Ne,ue))},ce=function(e,i,c){var v=z(z({},d(e,"style")||{}),d(e,"contentStyle")||{}),j=b+"_content_"+c,C=b+"_header_"+c,x=m.createRef(),B=r({id:j,ref:x,className:L(d(e,"contentClassName"),d(e,"className"),y("accordiontab.toggleablecontent")),style:v,role:"region","aria-labelledby":C},h(e,"toggleablecontent",c)),Q=r({className:y("accordiontab.content")},h(e,"content",c)),ue=r({classNames:y("accordiontab.transition"),timeout:{enter:1e3,exit:450},in:i,unmountOnExit:!0,options:f.transitionOptions},h(e,"transition",c));return m.createElement(Re,te({nodeRef:x},ue),m.createElement("div",B,m.createElement("div",Q,d(e,"children"))))},de=function(e,i){if(_.isValidChild(e,"AccordionTab")){var c=b+"_"+i,v=K(i),j=G(e,v,i),C=ce(e,v,i),x=r({key:c,className:y("accordiontab.root",{selected:v})},R.getCOtherProps(e),h(e,"root",i));return m.createElement("div",x,j,C)}return null},n=function(){return m.Children.map(f.children,de)},s=n(),u=r({className:L(f.className,y("root")),style:f.style},ee.getOtherProps(f),O("root"));return m.createElement("div",te({id:b,ref:P},u),s)});xe.displayName="AccordionTab";Te.displayName="Accordion";const Lt=({nombre:t,registros:a=[],paginaActual:r,perPage:p,total:f,onPageChange:w,recargar:g})=>{const b=m.useRef(null),[T,A]=m.useState((r-1)*p),[I,H]=m.useState(!1),[ae,P]=m.useState(!1),[N,k]=m.useState(!1),[U,S]=m.useState(null),[O,re]=m.useState(null),[y,q]=m.useState(null),[d,h]=m.useState([]);m.useState(t),m.useState("Generar y enviar el informe de ventas correspondiente a la semana actual al equipo de dirección.");const ne=(n,s,u)=>[{label:"Desvincular",icon:"pi pi-times",command:()=>{ve({message:"¿Estas seguro que deseas desvincular este registro?",header:"Confirmation",icon:"pi pi-exclamation-triangle",defaultFocus:"accept",accept:()=>{u=="Realizado"?b.current.show({severity:"warn",summary:"Delete",detail:"No es posible desvincular la activad, cuando ya fue Realizada"}):setTimeout(()=>{X(n)},10)},reject:G})}}],X=async n=>{const s={cotizacion_id:n};try{const u=await axios.post(route("desvincula.cotizacion"),s);console.log("Este es el desmadre",u);const{data:l,status:e}=u;e===201&&(b.current.show({severity:"success",summary:"Success",detail:`${l.success}`,life:3e3}),g(1))}catch(u){console.error(u),setLoading(!1),b.current.show({severity:"error",summary:"Error",detail:"Error al actualizar la actividad",life:3e3}),setDesabilitar(!1)}},J=[{name:"Baja",code:"Baja"},{name:"Media",code:"Media"},{name:"Alta",code:"Alta"}],V=[{name:"Pendiente",code:"Pendiente"},{name:"Realizado",code:"Realizado"}],oe=(n,s)=>{const u=[...d];u[s].titulo=n,h(u)},W=(n,s)=>{const u=[...d];u[s].prioridad=n.code,h(u)},Y=(n,s)=>{const u=[...d];u[s].estatus=n.code,h(u)},se=(n,s)=>{const u=[...d];u[s].fecha=n,h(u)},$=(n,s)=>{const u=[...d];u[s].descripcion=n,h(u)},F=n=>{const s=n.page+1;w(s)},ie=(n,s)=>{H(!0),S(n)},le=(n,s)=>{P(!0),re(n)};m.useEffect(()=>{h(a)},[a]),m.useEffect(()=>{A((r-1)*p)},[r,p]);const D=({responsable:n,titulo:s,descripcion:u,prioridad:l,estatus:e,fecha:i})=>s!=null&&s.trim()?u!=null&&u.trim()?l?e?i?null:"Selecciona una fecha.":"Selecciona un estatus.":"Selecciona una prioridad.":"La descripción es obligatoria.":"El título es obligatorio.",K=async(n,s)=>{const u={titulo:d[s].titulo,descripcion:d[s].descripcion,prioridad:d[s].prioridad,estatus:d[s].estatus,fecha:d[s].fecha},l=D(u);if(l){b.current.show({severity:"error",summary:"Error",detail:l,life:3e3});return}try{const e=await axios.put(route("activiades.update",n),u),{data:i,status:c}=e;c===200&&(b.current.show({severity:"success",summary:"Success",detail:`${i.success}`,life:3e3}),g(1))}catch(e){console.error(e),setLoading(!1),b.current.show({severity:"error",summary:"Error",detail:"Error al actualizar la actividad",life:3e3}),setDesabilitar(!1)}},G=()=>{b.current.show({severity:"warn",summary:"Rejected",detail:"No se realizo ningun cambio",life:3e3})},ce=(n,s)=>{ve({message:"¿Estas seguro que deseas actualizar este registro?",header:"Confirmation",icon:"pi pi-exclamation-triangle",defaultFocus:"accept",accept:()=>K(n,s),reject:G})},de=(n,s)=>{k(!0),q(n)};return o.jsxs("div",{className:"card",children:[o.jsx("div",{className:"grid m-1",children:o.jsx("div",{className:"col-12 text-right",children:o.jsx(Ue,{usuario:t,recargar:g})})}),d.length===0?o.jsx("div",{className:"p-4 text-gray-500 text-center italic",children:"No hay actividades registradas en el rango de fechas."}):o.jsx(o.Fragment,{children:o.jsx(Te,{activeIndex:0,children:d.map((n,s)=>{var u;return o.jsx(xe,{header:o.jsxs("span",{className:"flex align-items-center gap-2 w-full",children:[o.jsx("span",{className:"font-bold white-space-nowrap",children:o.jsx("strong",{children:n.titulo})}),o.jsx(Ke,{value:new Date(n.created_at).toLocaleDateString("es-MX"),className:"ml-auto"})]}),children:o.jsxs("div",{className:"flex flex-column gap-3",children:[o.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[o.jsxs("div",{className:"flex-auto min-w-[250px]",children:[o.jsx("label",{htmlFor:`responsable-${s}`,className:"font-bold block mb-2",children:"Responsable"}),o.jsx(be,{id:`responsable-${s}`,value:n.usuario.name,className:"w-full",placeholder:"Nombre del responsable",readOnly:!0})]}),o.jsxs("div",{className:"flex-auto min-w-[250px]",children:[o.jsx("label",{htmlFor:`titulo-${s}`,className:"font-bold block mb-2",children:"Titulo"}),o.jsx(be,{id:`titulo-${s}`,value:n.titulo,className:"w-full",placeholder:"Titulo",onChange:l=>oe(l.target.value,s),readOnly:n.estatus==="Realizado"})]}),o.jsxs("div",{className:"flex-auto min-w-[250px]",children:[o.jsx("label",{htmlFor:`prioridad-${s}`,className:"font-bold block mb-2",children:"Prioridad"}),o.jsx(he,{inputId:`prioridad-${s}`,value:J.find(l=>l.code===n.prioridad),onChange:l=>W(l.value,s),options:J,optionLabel:"name",placeholder:"Selecciona Prioridad",className:"w-full",disabled:n.estatus==="Realizado"})]}),o.jsxs("div",{className:"flex-auto min-w-[250px]",children:[o.jsx("label",{htmlFor:`estatus-${s}`,className:"font-bold block mb-2",children:"Estatus"}),o.jsx(he,{inputId:`estatus-${s}`,value:V.find(l=>l.code==n.estatus),onChange:l=>Y(l.value,s),options:V,optionLabel:"name",placeholder:"Selecciona Estatus",className:"w-full"})]}),o.jsxs("div",{className:"flex-auto min-w-[250px]",children:[o.jsx("label",{htmlFor:`fecha-${s}`,className:"font-bold block mb-2",children:"Fecha Limite"}),o.jsx(Me,{inputId:`fecha-${s}`,value:n.fecha?new Date(n.fecha):null,onChange:l=>se(l.value,s),dateFormat:"dd/mm/yy",className:"w-full",showIcon:!0,disabled:n.estatus==="Realizado"})]})]}),n.estatus,o.jsx(Le,{value:n.descripcion,onTextChange:l=>$(l.htmlValue,s),style:{height:"120px"},readOnly:(n==null?void 0:n.estatus)==="Realizado"},n.estatus),((u=n.cotizaciones)==null?void 0:u.length)>0&&o.jsxs(o.Fragment,{children:[o.jsx("p",{children:"Cotizaciones Asociadas"}),o.jsx("div",{className:"flex justify-center",children:o.jsx("div",{className:"flex gap-2",children:n.cotizaciones.map((l,e)=>o.jsx(Ve,{size:"small",label:l.folio??"Cotización",icon:"pi pi-external-link",onClick:()=>{setTimeout(()=>{window.open(route("cotizacion.captura.detalle",{identy:l.id}),"_blank")},10)},model:ne(l.id,e,n.estatus)},e))})})]}),o.jsx("div",{className:"flex justify-center",children:o.jsxs("div",{className:"flex gap-2 p-4",children:[o.jsx(Z,{label:"Asociar Cotización",className:"p-button-sm",onClick:()=>de(n.id),disabled:n.estatus==="Realizado"}),o.jsx(Z,{label:"Nueva Cotización",className:"p-button-sm",onClick:()=>le(n.id),disabled:n.estatus==="Realizado"}),o.jsx(Z,{label:"Actualizar",className:"p-button-sm",onClick:()=>ce(n.id,s)}),o.jsx(Z,{label:"Eliminar",className:"p-button-sm p-button-danger",onClick:()=>ie(n.id),disabled:n.estatus==="Realizado"})]})})]})},n.id)})})}),o.jsx(Be,{first:T,rows:p,totalRecords:f,onPageChange:F,rowsPerPageOptions:[20]}),o.jsx(Xe,{preguntaNuevaCotizacion:ae,setPreguntaNuevaCotizacion:P,identyNewCotizacion:O,recargar:g}),o.jsx(qe,{activarEliminar:I,setPreguntaEliminar:H,identyDelete:U,setIdentyDelete:S,recargar:g}),o.jsx(Je,{preguntaBusquedaCotizaciones:N,setPreguntaBusquedaCotizaciones:k,identyAsociaActividad:y,setIdentyAsociaActividad:q,recargar:g}),o.jsx($e,{}),o.jsx(Fe,{ref:b})]})};export{Lt as default};
//# sourceMappingURL=ListadoActividades-a8294589.js.map
