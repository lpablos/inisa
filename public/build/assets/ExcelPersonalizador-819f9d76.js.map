{"version":3,"file":"ExcelPersonalizador-819f9d76.js","sources":["../../../resources/js/Pages/LogsActividades/partials/ExcelPersonalizador.jsx"],"sourcesContent":["import React, { Component, useState, useEffect, useRef } from 'react';\nimport { Button } from 'primereact/button';\nimport { Dialog } from 'primereact/dialog';\nimport { ProgressSpinner } from 'primereact/progressspinner';\nimport { InputSwitch } from \"primereact/inputswitch\";\nimport { Inertia } from '@inertiajs/inertia';\nimport { Toast } from 'primereact/toast';\n\n\nconst ExcelPersonalizador = ({identyCotizacion =1, vistaPreviaExcel=false, setVistaPreviaExcel}) =>{\n    const toast = useRef(null);\n    const [visible, setVisible] = useState(false);\n\n    const [encabezado, setEncabezado] = useState(false);\n    const [piePagina, setpiePagina] = useState(false);\n    const [firma, setFirma] = useState(false);\n    const [pdfUrl, setPdfUrl] = useState(null);\n    const [load, setLoad]= useState(false)\n\n    useEffect(() => {\n        \n        \n        setPdfUrl(null)\n        setLoad(false)\n        resetOpt()        \n        setVisible(vistaPreviaExcel);\n    }, [vistaPreviaExcel]);\n\n   \n\n    const resetOpt = ()=>{\n        setEncabezado(false)\n        setpiePagina(false)\n        setFirma(false)\n        \n    }\n\n    const generarExcel = () =>{\n        setPdfUrl(null)\n        setLoad(true)\n        const url = `${route(\"exportar.excel.cotizacion\")}?id=${identyCotizacion}&encabezado=${encabezado}&pie-pagina=${piePagina}&firma=${firma}`;\n        setTimeout(() => {\n            toast.current.show({ severity:'success', summary: 'Exito', detail: 'Excel Descargado Correctamente' });\n            Inertia.visit(url, { method: 'get' }); // Realiza la navegación.\n            setLoad(false)\n        }, 1000);\n    }\n\n    return (\n        <Dialog header=\"Descargar Excel Cotización\" visible={visible} maximizable style={{ width: '50vw' }} onHide={() => {if (!visible) return; setVistaPreviaExcel(false); }}>\n\n            <div className=\"card flex flex-wrap gap-4 p-fluid\">\n                <div className=\"flex-auto text-center\">\n                    <label htmlFor=\"mile\" className=\"font-bold block mb-2\">Agregar encabezados</label>\n                    <InputSwitch checked={encabezado} onChange={(e) => setEncabezado(e.value)} /> <span>{encabezado?'SI':'NO'}</span>\n                </div>\n                <div className=\"flex-auto text-center\">\n                    <label htmlFor=\"percent\" className=\"font-bold block mb-2\">Agregar Pie de Pagina</label>\n                    <InputSwitch checked={piePagina} onChange={(e) => setpiePagina(e.value)} />{piePagina?'SI':'NO'}\n                </div>\n                <div className=\"flex-auto text-center\">\n                    <label htmlFor=\"expiry\" className=\"font-bold block mb-2\">Agregar Firma</label>\n                    <InputSwitch checked={firma} onChange={(e) => setFirma(e.value)} />{firma?'SI':'NO'}\n                </div>\n                <div className=\"flex-auto\">\n                    <Button label=\"Desgar Excel\" iconPos=\"right\" onClick={()=>generarExcel()} disabled={load}/>\n                </div>\n            </div>\n            {load && (\n                <div className=\"flex justify-content-center\">\n                    <ProgressSpinner />\n                </div>\n            )}\n\n            <div className=\" flex justify-content-center\">\n                <Toast ref={toast} position=\"top-left\"/>\n            </div>\n         \n        </Dialog>\n    );\n    \n}\n\nexport default ExcelPersonalizador;"],"names":["ExcelPersonalizador","identyCotizacion","vistaPreviaExcel","setVistaPreviaExcel","toast","useRef","visible","setVisible","useState","encabezado","setEncabezado","piePagina","setpiePagina","firma","setFirma","pdfUrl","setPdfUrl","load","setLoad","useEffect","resetOpt","generarExcel","url","Inertia","jsxs","Dialog","jsx","InputSwitch","e","Button","ProgressSpinner","Toast"],"mappings":"ijBASM,MAAAA,EAAsB,CAAC,CAAC,iBAAAC,EAAkB,EAAG,iBAAAC,EAAiB,GAAO,oBAAAC,KAAwB,CACzF,MAAAC,EAAQC,SAAO,IAAI,EACnB,CAACC,EAASC,CAAU,EAAIC,WAAS,EAAK,EAEtC,CAACC,EAAYC,CAAa,EAAIF,WAAS,EAAK,EAC5C,CAACG,EAAWC,CAAY,EAAIJ,WAAS,EAAK,EAC1C,CAACK,EAAOC,CAAQ,EAAIN,WAAS,EAAK,EAClC,CAACO,EAAQC,CAAS,EAAIR,WAAS,IAAI,EACnC,CAACS,EAAMC,CAAO,EAAGV,WAAS,EAAK,EAErCW,EAAAA,UAAU,IAAM,CAGZH,EAAU,IAAI,EACdE,EAAQ,EAAK,EACJE,IACTb,EAAWL,CAAgB,CAAA,EAC5B,CAACA,CAAgB,CAAC,EAIrB,MAAMkB,EAAW,IAAI,CACjBV,EAAc,EAAK,EACnBE,EAAa,EAAK,EAClBE,EAAS,EAAK,CAAA,EAIZO,EAAe,IAAK,CACtBL,EAAU,IAAI,EACdE,EAAQ,EAAI,EACZ,MAAMI,EAAM,GAAG,MAAM,2BAA2B,CAAC,OAAOrB,CAAgB,eAAeQ,CAAU,eAAeE,CAAS,UAAUE,CAAK,GACxI,WAAW,IAAM,CACPT,EAAA,QAAQ,KAAK,CAAE,SAAS,UAAW,QAAS,QAAS,OAAQ,gCAAA,CAAkC,EACrGmB,EAAA,QAAQ,MAAMD,EAAK,CAAE,OAAQ,KAAO,CAAA,EACpCJ,EAAQ,EAAK,GACd,GAAI,CAAA,EAGX,OACKM,EAAA,KAAAC,EAAA,CAAO,OAAO,6BAA6B,QAAAnB,EAAkB,YAAW,GAAC,MAAO,CAAE,MAAO,MAAO,EAAG,OAAQ,IAAM,CAAMA,GAAiBH,EAAoB,EAAK,CAE9J,EAAA,SAAA,CAACqB,EAAAA,KAAA,MAAA,CAAI,UAAU,oCACX,SAAA,CAACA,EAAAA,KAAA,MAAA,CAAI,UAAU,wBACX,SAAA,CAAAE,MAAC,QAAM,CAAA,QAAQ,OAAO,UAAU,uBAAuB,SAAmB,sBAAA,EAC1EA,EAAAA,IAACC,EAAY,CAAA,QAASlB,EAAY,SAAWmB,GAAMlB,EAAckB,EAAE,KAAK,CAAG,CAAA,EAAE,IAAEF,EAAA,IAAA,OAAA,CAAM,SAAWjB,EAAA,KAAK,KAAK,CAAA,EAC9G,EACAe,EAAAA,KAAC,MAAI,CAAA,UAAU,wBACX,SAAA,CAAAE,MAAC,QAAM,CAAA,QAAQ,UAAU,UAAU,uBAAuB,SAAqB,wBAAA,EAC/EA,EAAAA,IAACC,EAAY,CAAA,QAAShB,EAAW,SAAWiB,GAAMhB,EAAagB,EAAE,KAAK,CAAG,CAAA,EAAGjB,EAAU,KAAK,IAAA,EAC/F,EACAa,EAAAA,KAAC,MAAI,CAAA,UAAU,wBACX,SAAA,CAAAE,MAAC,QAAM,CAAA,QAAQ,SAAS,UAAU,uBAAuB,SAAa,gBAAA,EACtEA,EAAAA,IAACC,EAAY,CAAA,QAASd,EAAO,SAAWe,GAAMd,EAASc,EAAE,KAAK,CAAG,CAAA,EAAGf,EAAM,KAAK,IAAA,EACnF,QACC,MAAI,CAAA,UAAU,YACX,SAAAa,EAAA,IAACG,GAAO,MAAM,eAAe,QAAQ,QAAQ,QAAS,IAAIR,EAAgB,EAAA,SAAUJ,CAAK,CAAA,EAC7F,CAAA,EACJ,EACCA,GACIS,EAAA,IAAA,MAAA,CAAI,UAAU,8BACX,SAAAA,MAACI,GAAgB,CAAA,EACrB,EAGJJ,EAAAA,IAAC,MAAI,CAAA,UAAU,+BACX,SAAAA,EAAA,IAACK,GAAM,IAAK3B,EAAO,SAAS,UAAA,CAAU,CAC1C,CAAA,CAEJ,CAAA,CAAA,CAGR"}