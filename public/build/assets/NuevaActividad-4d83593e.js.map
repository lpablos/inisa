{"version":3,"file":"NuevaActividad-4d83593e.js","sources":["../../../resources/js/Pages/Actividades/Partials/NuevaActividad.jsx"],"sourcesContent":["\nimport React, { Component, useState, useEffect, useRef } from \"react\";\nimport { Card } from 'primereact/card';\nimport { Button } from 'primereact/button';\nimport { Dialog } from 'primereact/dialog';\nimport { Editor } from 'primereact/editor';\nimport { InputText } from 'primereact/inputtext';\nimport { Dropdown } from 'primereact/dropdown';\nimport { Calendar } from 'primereact/calendar';\nimport { Toast } from 'primereact/toast';    \nimport { ProgressSpinner } from 'primereact/progressspinner';    \nimport axios from \"axios\";\n\nconst NuevaActividad = ({usuario, recargar}) => {\n    const [responsable, setResponsable] = useState('');\n    const [titulo, setTitulo] = useState('');\n    const [prioridad, setPrioridad] = useState(null);\n    const [estatus, setEstatus] = useState(null);\n    const [fecha, setFecha] = useState(null);\n    const [fechaAsociada, setFechaAsociada] = useState(null)\n    const [text, setText] = useState('');\n    const [visible, setVisible] = useState(false);\n    const [desabilitar, setDesabilitar] = useState(false)\n    const toast = useRef(null);\n       \n    // Funcion para formatear las fechas\n    useEffect(()=>{\n        let fechaFormato = fecha ? fecha.toISOString().slice(0, 10) : null;\n        setFechaAsociada(fechaFormato)\n    },[fecha]);\n    \n    const prioridades = [\n        { label: 'Alta', value: 'alta' },\n        { label: 'Media', value: 'media' },\n        { label: 'Baja', value: 'baja' },\n    ];\n    \n    const estatuses = [\n        { label: 'Pendiente', value: 'pendiente' },\n        { label: 'Realizado', value: 'realizado' },\n    ];\n    const [loading,setLoading] = useState(false);\n    \n    \n\n    useEffect(()=>{\n        setResponsable(usuario);\n    },[])\n\n    const limpiarFormulario = () =>{\n        setTitulo('')\n        setPrioridad(null)\n        setEstatus(null)\n        setFecha(null)\n        setFechaAsociada(null)\n        setText('')\n    }\n    // Funcion de validacion de informacion\n    const validarDatos = ({ responsable, titulo, descripcion, prioridad, estatus, fecha }) => {\n        if (!responsable) return \"Debes seleccionar un responsable.\";\n        if (!titulo?.trim()) return \"El título es obligatorio.\";\n        if (!descripcion?.trim()) return \"La descripción es obligatoria.\";\n        if (!prioridad) return \"Selecciona una prioridad.\";\n        if (!estatus) return \"Selecciona un estatus.\";\n        if (!fecha) return \"Selecciona una fecha.\";\n\n        return null; // Todo correcto\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault(); // Evita que el formulario recargue la página        \n        const datos = {\n            responsable: responsable,\n            titulo:titulo,\n            descripcion:text,\n            prioridad: prioridad,\n            estatus: estatus,\n            fecha: fechaAsociada,\n        }\n        const error = validarDatos(datos);\n        if (error) {\n            toast.current.show({\n                severity: \"error\",\n                summary: \"Error\",\n                detail: error,\n                life: 3000,\n            });\n            return;\n        }\n\n        setLoading(true)\n        setDesabilitar(true)\n\n        try {\n            const response = await axios.post(route(\"activiades.store\"), datos);            \n            const { data, status} = response\n            // console.log(\"Esto es\", response);\n            \n            if (status === 200) {\n                toast.current.show({\n                    severity: \"success\",\n                    summary: \"Success\",\n                    detail: `${data.success}`,\n                    life: 3000,\n                });\n                recargar(1)\n                limpiarFormulario()\n                setVisible(false)\n                setDesabilitar(false)\n                setTimeout(() => {\n                    setLoading(false)\n                }, 1000);\n                // Aqui tiene que funcionar\n                // reloadRegistros()\n            }\n        } catch (error) {\n            console.error(error);\n            setLoading(false)\n            toast.current.show({\n                severity: \"error\",\n                summary: \"Error\",\n                detail: \"Error al registrar la actividad\",\n                life: 3000,\n            });\n            setDesabilitar(false)\n        }\n    };\n\n\n    return (    \n        <>\n            <Toast ref={toast} />\n            <Button\n                \n                icon=\"pi pi-paperclip\"\n                onClick={() => setVisible(true)}\n                tooltip=\"Nueva Actividad\"\n                tooltipOptions={{ position: \"bottom\", showDelay: 200, hideDelay: 300 }}\n                className=\"p-button-rounded p-button-info p-button-sm mr-1\"\n            />\n\n            <Dialog header=\"Actividad\" visible={visible} maximizable style={{ width: '50vw' }} onHide={() => {if (!visible) return; setVisible(false); }}>\n                <form action=\"\" onSubmit={handleSubmit}>\n                    <div className=\"flex flex-column gap-3\">\n                        <div className=\"flex flex-wrap gap-3 mb-4\">\n                            <div className=\"flex-auto min-w-[250px]\">\n                                <label htmlFor={`responsable`} className=\"font-bold block mb-2\">Responsable</label>\n                                <InputText id={`responsable`} value={responsable} onChange={(e) => setResponsable(e.target.value)} className=\"w-full\" placeholder=\"Nombre del responsable\" readOnly={true}/>\n                            </div>\n                          \n                            <div className=\"flex-auto min-w-[250px]\">\n                                <label htmlFor={`prioridad`} className=\"font-bold block mb-2\">Prioridad *</label>\n                                <Dropdown inputId={`prioridad`} value={prioridad} options={prioridades} onChange={(e) => setPrioridad(e.value)} placeholder=\"Selecciona Prioridad\" className=\"w-full\"/>\n                            </div>\n\n                            <div className=\"flex-auto min-w-[250px]\">\n                                <label htmlFor={`estatus`} className=\"font-bold block mb-2\">Estatus *</label>\n                                <Dropdown inputId={`estatus`} value={estatus} options={estatuses} onChange={(e) => setEstatus(e.value)} placeholder=\"Selecciona Estatus\" className=\"w-full\"/>\n                            </div>\n\n                            <div className=\"flex-auto min-w-[250px]\">\n                                <label htmlFor={`fecha`} className=\"font-bold block mb-2\">Fecha Limite *</label>\n                                <Calendar inputId={`fecha`} value={fecha} onChange={(e) => setFecha(e.value)} dateFormat=\"dd/mm/yy\" className=\"w-full\" showIcon/>\n                            </div>\n                            <div className=\"flex-auto min-w-[250px]\">\n                                <label htmlFor={`titulo`} className=\"font-bold block mb-2\">Titulo *</label>\n                                <InputText id={`titulo`} value={titulo} onChange={(e) => setTitulo(e.target.value)} className=\"w-full\" placeholder=\"Nombre de la actividad\"/>\n                            </div>\n                        </div>\n\n                        <Editor value={text} onTextChange={(e) => setText(e.htmlValue)} style={{ height: '120px' }} />\n                        {loading && (\n                            <div className=\"flex justify-content-center\">\n                                <ProgressSpinner />\n                            </div>\n                        )}\n                        <div className=\"flex items-center gap-3\">\n                            <div className=\"ml-auto flex gap-2\">\n                                <Button label=\"Guardar\" disabled={desabilitar} size=\"small\"/>\n                            </div>\n                        </div>           \n                    </div>\n                </form>\n            </Dialog>\n        </>\n            \n  \n    );\n};\n\nexport default NuevaActividad;"],"names":["NuevaActividad","usuario","recargar","responsable","setResponsable","useState","titulo","setTitulo","prioridad","setPrioridad","estatus","setEstatus","fecha","setFecha","fechaAsociada","setFechaAsociada","text","setText","visible","setVisible","desabilitar","setDesabilitar","toast","useRef","useEffect","fechaFormato","prioridades","estatuses","loading","setLoading","limpiarFormulario","validarDatos","descripcion","handleSubmit","e","datos","error","response","axios","data","status","jsxs","Fragment","jsx","Toast","Button","Dialog","InputText","Dropdown","Calendar","Editor","ProgressSpinner"],"mappings":"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"}