import{r as s,j as e}from"./app-6c82f11e.js";import{B as u}from"./button.esm-41370389.js";import{D as B}from"./dialog.esm-1817fed8.js";import{I as g}from"./inputtext.esm-637833b0.js";import{C as H}from"./calendar.esm-d23b41df.js";import{D as L,C as n}from"./column.esm-a678af90.js";import{T as W}from"./toast.esm-8381782e.js";import"./iconbase.esm-c62f15b0.js";import"./index.esm-e44f5f68.js";import"./ripple.esm-79db3f70.js";import"./tooltip.esm-0f28f899.js";import"./csstransition.esm-09727ec9.js";import"./index.esm-366dce1b.js";import"./overlayservice.esm-c4b1edec.js";import"./index.esm-39b5d000.js";import"./dropdown.esm-afaf7a02.js";import"./virtualscroller.esm-cb5beb47.js";import"./index.esm-c60f89d0.js";import"./inputnumber.esm-83251a88.js";import"./index.esm-ad4d5920.js";import"./index.esm-971704a7.js";import"./index.esm-7f14e7bd.js";import"./index.esm-86191ea3.js";const me=({preguntaBusquedaCotizaciones:m,setPreguntaBusquedaCotizaciones:f,identyAsociaActividad:p,setIdentyAsociaActividad:C,recargar:S})=>{const r=s.useRef(null),[l,d]=s.useState(!1),[T,i]=s.useState(!1),[h,x]=s.useState(""),[b,j]=s.useState(""),[v,y]=s.useState(null),[F,z]=s.useState([]),[E,w]=s.useState(null);s.useEffect(()=>{m&&(d(m),w(p))},[m,p]),s.useEffect(()=>{l===!1&&(f(l),N())},[l]);const N=()=>{x(""),j(""),y(null),z([]),w(null)},k=({cotizacion:t,titulo:a,fecha:o})=>t&&t.trim()!==""||a&&a.trim()!==""||o?null:"Debes ingresar al menos uno de los siguientes campos: Cotización, Título o Fecha.",A=async t=>{t.preventDefault(),i(!0);const a={cotizacion:h,titulo:b,fecha:v},o=k(a);if(o){i(!1),r.current.show({severity:"error",summary:"Error",detail:o,life:3e3});return}D(a)},D=async t=>{try{const a=await axios.get(route("busqueda.actividades.cotizacion"),{params:t}),{status:o,data:c}=a;o===200&&(z(c),i(!1))}catch{i(!1),alert("Error")}},V=t=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{label:"Ver",size:"small",icon:"pi pi-eye",className:"p-button-sm p-button-info",rounded:!0,onClick:()=>I(t)}),e.jsx(u,{label:"Asociar",size:"small",icon:"pi pi-link",className:"p-button-sm p-button-secondary",rounded:!0,onClick:()=>_(t)})]}),I=t=>{const a=route("cotizacion.captura.detalle",t.id);window.open(a,"_blank")},_=async t=>{try{const a={id_cotizacion:t.id,id_actividad:E},o=await axios.post(route("asociar.cotizacion.actividad"),a),{data:c,status:R}=o;R===201&&(r.current.show({severity:"success",summary:"Success",detail:`${c.success}`,life:3e3}),N(),C(null),S(1),d(!1),i(!1),f(!1))}catch{i(!1),r.current.show({severity:"error",summary:"Error",detail:"Error al asociar Actividad con la cotizacion",life:3e3})}};return e.jsxs("div",{className:"flex justify-content-center",children:[e.jsxs(B,{header:"Asociar de Tarea y Cotización",visible:l,maximizable:!0,style:{width:"50vw"},onHide:()=>{l&&d(!1)},children:[e.jsx("form",{onSubmit:A,children:e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsxs("div",{className:"flex-auto min-w-[250px]",children:[e.jsx("label",{htmlFor:"cotizacion",className:"font-bold block mb-2",children:"Cotización"}),e.jsx(g,{id:"cotizacion",value:h,onChange:t=>x(t.target.value),placeholder:"Número o código de cotización",className:"w-full"})]}),e.jsxs("div",{className:"flex-auto min-w-[250px]",children:[e.jsx("label",{htmlFor:"titulo",className:"font-bold block mb-2",children:"Título"}),e.jsx(g,{id:"titulo",value:b,onChange:t=>j(t.target.value),placeholder:"Escribe el título",className:"w-full"})]}),e.jsxs("div",{className:"flex-auto min-w-[250px]",children:[e.jsx("label",{htmlFor:"fecha",className:"font-bold block mb-2",children:"Fecha"}),e.jsx(H,{id:"fecha",value:v,onChange:t=>y(t.value),dateFormat:"dd/mm/yy",placeholder:"Selecciona fecha",className:"w-full",showIcon:!0})]}),e.jsx("div",{className:"flex justify-content-center",children:e.jsx(u,{label:"Buscar",type:"submit",size:"small",loading:T})})]})}),e.jsxs(L,{value:F,size:"small",tableStyle:{minWidth:"50rem"},children:[e.jsx(n,{field:"folio",header:"Folio"}),e.jsx(n,{field:"titulo",header:"Titulo"}),e.jsx(n,{field:"fecha",header:"Fecha"}),e.jsx(n,{header:"Acciones",body:V,style:{width:"150px"}})]})]}),e.jsx(W,{ref:r})]})};export{me as default};
//# sourceMappingURL=BuscadorCotizacion-6b7a3b27.js.map
