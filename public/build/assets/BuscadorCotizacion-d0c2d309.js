import{r as a,j as e}from"./app-19db06cb.js";import{B as d}from"./button.esm-8dbecc90.js";import{D as B}from"./dialog.esm-18943087.js";import{I as g}from"./inputtext.esm-06be2f11.js";import{C as H}from"./calendar.esm-94497439.js";import{D as L,C as n}from"./column.esm-2e0db536.js";import{T as W}from"./toast.esm-0ed1f3f5.js";import"./iconbase.esm-8ede90bc.js";import"./index.esm-e985f2f4.js";import"./ripple.esm-586a3f44.js";import"./tooltip.esm-01d8262e.js";import"./csstransition.esm-dcf34adf.js";import"./index.esm-a014419b.js";import"./overlayservice.esm-1e88b1a3.js";import"./index.esm-87540949.js";import"./index.esm-19bb07b4.js";import"./inputnumber.esm-1f5b4141.js";import"./index.esm-4dc81cb8.js";import"./index.esm-6b85df90.js";import"./dropdown.esm-5f54d0b4.js";import"./virtualscroller.esm-3b43f60c.js";import"./index.esm-2b3c0470.js";import"./index.esm-6d34e67f.js";import"./index.esm-fe6507a8.js";const ue=({preguntaBusquedaCotizaciones:m,setPreguntaBusquedaCotizaciones:f,identyAsociaActividad:p,setIdentyAsociaActividad:C,recargar:S})=>{const l=a.useRef(null),[r,u]=a.useState(!1),[T,i]=a.useState(!1),[h,x]=a.useState(""),[b,j]=a.useState(""),[v,y]=a.useState(null),[F,z]=a.useState([]),[E,w]=a.useState(null);a.useEffect(()=>{m&&(u(m),w(p))},[m,p]),a.useEffect(()=>{r===!1&&(f(r),N())},[r]);const N=()=>{x(""),j(""),y(null),z([]),w(null)},k=({cotizacion:t,titulo:s,fecha:o})=>t&&t.trim()!==""||s&&s.trim()!==""||o?null:"Debes ingresar al menos uno de los siguientes campos: Cotización, Título o Fecha.",A=async t=>{t.preventDefault(),i(!0);const s={cotizacion:h,titulo:b,fecha:v},o=k(s);if(o){i(!1),l.current.show({severity:"error",summary:"Error",detail:o,life:3e3});return}D(s)},D=async t=>{try{const s=await axios.get(route("busqueda.actividades.cotizacion"),{params:t}),{status:o,data:c}=s;o===200&&(c.length==0&&l.current.show({severity:"info",summary:"Info",detail:"No se encontraron suficientes registros",life:5e3}),z(c),i(!1))}catch{i(!1),alert("Error")}},V=t=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{label:"Ver",size:"small",icon:"pi pi-eye",className:"p-button-sm p-button-info",rounded:!0,onClick:()=>I(t)}),e.jsx(d,{label:"Asociar",size:"small",icon:"pi pi-link",className:"p-button-sm p-button-secondary",rounded:!0,onClick:()=>_(t)})]}),I=t=>{const s=route("cotizacion.captura.detalle",t.id);window.open(s,"_blank")},_=async t=>{try{const s={id_cotizacion:t.id,id_actividad:E},o=await axios.post(route("asociar.cotizacion.actividad"),s),{data:c,status:R}=o;R===201&&(l.current.show({severity:"success",summary:"Success",detail:`${c.success}`,life:3e3}),N(),C(null),S(1),u(!1),i(!1),f(!1))}catch{i(!1),l.current.show({severity:"error",summary:"Error",detail:"Error al asociar Actividad con la cotizacion",life:3e3})}};return e.jsxs("div",{className:"flex justify-content-center",children:[e.jsxs(B,{header:"Asociar de Tarea y Cotización",visible:r,maximizable:!0,style:{width:"50vw"},onHide:()=>{r&&u(!1)},children:[e.jsx("form",{onSubmit:A,children:e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsxs("div",{className:"flex-auto min-w-[250px]",children:[e.jsx("label",{htmlFor:"cotizacion",className:"font-bold block mb-2",children:"Cotización"}),e.jsx(g,{id:"cotizacion",value:h,onChange:t=>x(t.target.value),placeholder:"Número o código de cotización",className:"w-full"})]}),e.jsxs("div",{className:"flex-auto min-w-[250px]",children:[e.jsx("label",{htmlFor:"titulo",className:"font-bold block mb-2",children:"Título"}),e.jsx(g,{id:"titulo",value:b,onChange:t=>j(t.target.value),placeholder:"Escribe el título",className:"w-full"})]}),e.jsxs("div",{className:"flex-auto min-w-[250px]",children:[e.jsx("label",{htmlFor:"fecha",className:"font-bold block mb-2",children:"Fecha"}),e.jsx(H,{id:"fecha",value:v,onChange:t=>y(t.value),dateFormat:"dd/mm/yy",placeholder:"Selecciona fecha",className:"w-full",showIcon:!0})]}),e.jsx("div",{className:"flex justify-content-center",children:e.jsx(d,{label:"Buscar",type:"submit",size:"small",loading:T})})]})}),e.jsxs(L,{value:F,size:"small",tableStyle:{minWidth:"50rem"},children:[e.jsx(n,{field:"folio",header:"Folio"}),e.jsx(n,{field:"titulo",header:"Titulo"}),e.jsx(n,{field:"fecha",header:"Fecha"}),e.jsx(n,{header:"Acciones",body:V,style:{width:"150px"}})]})]}),e.jsx(W,{ref:l})]})};export{ue as default};
//# sourceMappingURL=BuscadorCotizacion-d0c2d309.js.map
