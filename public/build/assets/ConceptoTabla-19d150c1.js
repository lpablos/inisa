import{r as i,j as t,a as f}from"./app-dcb6f552.js";import"./index-f3d9d141.js";import{D as Q,C as n}from"./column.esm-212fd85e.js";import{B as l}from"./button.esm-46e694e9.js";import{T as X}from"./toast.esm-b4d4ac55.js";import Z from"./Dialogo-96bda2b3.js";import ee from"./ConfirmarEliminacion-9b8445bc.js";import te from"./ConfirmarDuplicacion-7092b5e8.js";import{T as j}from"./tooltip.esm-3383bdb1.js";import{B as oe}from"./badge.esm-a1474c6d.js";import ie from"./VistaPreviaCotizacion-2b088f7e.js";import se from"./CodigosDialog-97537c0a.js";import ae from"./BusquedaCotizacion-4870f3c6.js";import{P as re}from"./progressspinner.esm-67f32af2.js";import{M as ne}from"./message.esm-2c2b0b53.js";import le from"./BusquedaAvanzadaCotizacion-ae466897.js";import ce from"./ExcelPersonalizador-7a9b9c71.js";import"./componentbase.esm-1becf919.js";import"./iconbase.esm-565044fd.js";import"./index.esm-caaa0bd1.js";import"./ripple.esm-bef0a74b.js";import"./inputnumber.esm-b35cac15.js";import"./index.esm-a09854cd.js";import"./inputtext.esm-21a8a940.js";import"./index.esm-e233148e.js";import"./dropdown.esm-e750cd64.js";import"./index.esm-727a66c6.js";import"./index.esm-c88ad067.js";import"./csstransition.esm-4d025c04.js";import"./virtualscroller.esm-572a5462.js";import"./index.esm-bc560454.js";import"./index.esm-26c769ed.js";import"./index.esm-d80e96df.js";import"./index.esm-4dd38ef7.js";import"./dialog.esm-84a5e061.js";import"./floatlabel.esm-9aa8bf0c.js";import"./calendar.esm-e19123ec.js";import"./SelectorFilter-e722e6f6.js";import"./confirmdialog.esm-7f1ebc12.js";import"./selectbutton.esm-bc587bba.js";import"./divider.esm-f47843a3.js";import"./fieldset.esm-1a01d11e.js";import"./avatar.esm-61520b2c.js";import"./inputswitch.esm-370bc1bb.js";const et=()=>{const[b,g]=i.useState(null),[v,h]=i.useState(!1),[d,c]=i.useState([]),[E,u]=i.useState(null),[D,m]=i.useState(!1),[S,x]=i.useState(!1),[y,a]=i.useState(!1),s=i.useRef(null),[N,z]=i.useState(!1),[w,P]=i.useState(null),[T,F]=i.useState(null),[k,C]=i.useState(!1),[B,O]=i.useState(null),$=e=>{const{cotizaciones:o}=e;c([]),a(!0),setTimeout(()=>{o.length>0?s.current.show({severity:"success",summary:"Cotizaciones",detail:"Se encontraron registros",life:3e3}):s.current.show({severity:"info",summary:"Cotizaciones",detail:"No se encontraron suficientes registros.. Intenta con otros valores",life:3e3}),c(o),a(!1)},2e3)},r=async()=>{c([]),a(!0);try{const e=await f.get(route("cotizacion.list.cotizaciones"),{params:{estatus:T}}),{cotizaciones:o}=e.data;o.length>0&&c(o),a(!1)}catch(e){console.error("Error al obtener cotizaciones:",e),c([]),a(!1)}};i.useEffect(()=>{setTimeout(()=>{r()},1e3)},[]);const q=()=>{u(null),x(!1),m(!0)},A=e=>{u(e),x(!0),m(!0),console.log(e)},V=e=>t.jsxs("div",{className:"flex justify-content-center",children:[t.jsx("span",{className:"p-overlay-badge","data-pr-tooltip":e.estatus.descripcion,id:`tooltip-${e.id}`,children:t.jsx(oe,{value:e.estatus.abreviacion})}),t.jsx(j,{target:`#tooltip-${e.id}`})]}),I=e=>t.jsxs("div",{style:{display:"flex",gap:"18px",width:"45 rem"},children:[e.es_material==1&&"Material",e.es_mano_obra==1&&"Material Con Mano de Obra"]}),M=e=>{const o=new Date(e.fecha),K=`${o.getDate()}-${o.getMonth()+1}-${o.getFullYear()}`;return t.jsx(t.Fragment,{children:K})},_=async e=>{a(!0);try{await f.delete(route("cotizacion.delete.cotizacion",{id:e})),s.current.show({severity:"success",summary:"Cotización eliminada",detail:"La cotización ha sido eliminada exitosamente.",life:3e3}),r()}catch(o){s.current.show({severity:"error",summary:"Error",detail:"No se pudo eliminar la cotización.",life:3e3}),console.error("Error al eliminar cotización:",o)}finally{a(!1)}},L=(e,o)=>{s.current.show({severity:"warn",summary:"Confirmación",sticky:!0,content:t.jsx(ee,{mensaje:`¿Estás seguro de eliminar la cotización "${o}"?`,onConfirm:()=>{_(e),s.current.clear()},onCancel:()=>s.current.clear()})})},R=(e,o)=>{s.current.show({severity:"warn",summary:"Confirmación",sticky:!0,content:t.jsx(te,{mensaje:`¿Estás seguro de duplicar la cotización "${o}"?`,onConfirm:()=>{H(e),s.current.clear()},onCancel:()=>s.current.clear()})})},H=async e=>{a(!0);try{await f.post(route("cotizacion.duplicar.cotizacion",{id:e})),s.current.show({severity:"success",summary:"Cotización duplicada",detail:"La cotización ha sido duplicada exitosamente.",life:3e3}),r()}catch(o){s.current.show({severity:"error",summary:"Error",detail:"No se pudo duplicar la cotización.",life:3e3}),console.error("Error al duplicar la  cotización:",o)}finally{a(!1)}},U=e=>{O(e),setTimeout(()=>{C(!0)},500)},W=e=>{P(e),setTimeout(()=>{z(!0)},500)},Y=e=>t.jsxs("div",{className:"flex gap-2",children:[t.jsx("a",{id:"capture-link",href:route("cotizacion.captura.detalle",{identy:e.id}),size:"small",rel:"noopener noreferrer",className:"p-button-rounded p-button",children:t.jsx("i",{className:"pi pi-pencil"})}),t.jsx(l,{size:"small",icon:"pi pi-folder-open",tooltip:"Detalle",tooltipOptions:{position:"bottom",showDelay:200,hideDelay:300},className:"p-button-rounded p-button-info p-button-sm",onClick:()=>A(e)}),t.jsx(l,{severity:"success",size:"small",icon:"pi pi-file-excel",tooltip:"Vista Previa Excel",tooltipOptions:{position:"bottom",showDelay:200,hideDelay:300},className:"p-button-rounded p-button-info p-button-sm",onClick:()=>U(e.id)}),t.jsx(l,{severity:"success",size:"small",icon:"pi pi-file-pdf",tooltip:"Vista Previa PDF",tooltipOptions:{position:"bottom",showDelay:200,hideDelay:300},className:"p-button-rounded p-button-info p-button-sm",onClick:()=>W(e.id)}),t.jsx(l,{size:"small",className:"p-button-rounded p-button-secondary p-button-sm",tooltipOptions:{position:"bottom",showDelay:200,hideDelay:300},tooltip:"Agregar Codigo",icon:"pi pi-qrcode",onClick:()=>{h(!0),g(e.id)}}),t.jsx(l,{size:"small",icon:"pi pi-copy",className:"p-button-rounded p-button-warning p-button-sm",tooltip:"Duplicar",tooltipOptions:{position:"bottom",showDelay:200,hideDelay:300},onClick:()=>R(e.id,e.titulo)}),t.jsx(l,{size:"small",icon:"pi pi-trash",className:"p-button-rounded p-button-danger p-button-sm",tooltip:"Eliminar",tooltipOptions:{position:"bottom",showDelay:200,hideDelay:300},onClick:()=>L(e.id,e.titulo)}),t.jsx(j,{target:"#capture-link",content:"Captura la cotizacion",position:"bottom"})]}),p=()=>{m(!1),u(null)},G=e=>{r(),h(e)},J=e=>{a(!0);const{id:o}=e;F(o),setTimeout(()=>{r()},1e3)};return t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"flex justify-end items-center gap-x-4 flex-wrap mb-7",children:[t.jsx(ae,{className:"mr-2",activarBusqueda:J}),t.jsx(l,{icon:"pi pi-plus",tooltip:"Nueva Cotización",tooltipOptions:{showDelay:100,hideDelay:300},rounded:!0,severity:"info",className:"ml-2","aria-label":"Nueva Cotización",onClick:q}),t.jsx(le,{resultadosBusqueda:$})]}),y&&t.jsx("div",{className:"card flex justify-content-center",children:t.jsx(re,{})}),y===!1&&t.jsxs(t.Fragment,{children:[d.length>0&&t.jsxs(Q,{value:d,paginator:!0,rows:40,size:"small",children:[t.jsx(n,{field:"id",header:"ID",headerStyle:{textAlign:"center"}}),t.jsx(n,{field:"folio",header:"Cotización Folio",headerStyle:{textAlign:"center",fontWeight:"bold"}}),t.jsx(n,{field:"titulo",header:"Título",headerStyle:{textAlign:"center"}}),t.jsx(n,{field:"fecha",header:"Fecha",style:{width:"9em"},body:e=>M(e)}),t.jsx(n,{header:"Plantilla",style:{width:"9em"},body:e=>I(e)}),t.jsx(n,{field:"estatus.nombre",header:"Status",body:e=>V(e)}),t.jsx(n,{header:"Acciones",body:Y})]}),d.length===0&&t.jsx("div",{className:"card flex justify-content-center",children:t.jsx(ne,{text:"No se encontraron suficientes registros"})})]}),t.jsx(X,{ref:s}),D&&t.jsx(Z,{isEdit:S,dataToEdit:E,onSave:()=>{p(),r()},onUpdate:()=>{p(),r()},onClose:p}),t.jsx(se,{seleccionCotizacion:b,codigosShow:v,setCodigosShow:G}),t.jsx(ie,{identyCotizacion:w,vistraPreviaPDF:N,setVistraPreviaPDF:z}),t.jsx(ce,{identyCotizacion:B,vistaPreviaExcel:k,setVistaPreviaExcel:C})]})};export{et as default};
//# sourceMappingURL=ConceptoTabla-19d150c1.js.map
